<?php
   //1.确定应用名称一个叫做前台应用Home 一个叫后台应用Admin
   define('APP_NAME','Home');
   //2.确定应用路径 ./代表当前目录下 当前脚本的前 所有目录的名称首字母必须大写
   define('APP_PATH','./Home/');
   //3.应用核心文件 严格区分大小写 Linux环境严格匹配大小写 include并不产生致命的错误
   require './ThinkPHP/ThinkPHP.php';
 ?>
 =========================================================================================
 第二课代码 
http://127.0.0.1/index.php?m=Index&a=show
http://127.0.0.1/index.php?m=Index&a=show&name=tony

M 类文件操作数据 C类文件功能操作模块封装方法 V html文件编写对应的模板
 IndexAction.class.php 代码
 <?php
 //本类由系统自动生成，仅供测试用途
 class IndexAction extends Action{
   public function index(){
     echo "Hello World!!";
   }
   public function show(){
     //echo "访问了Index模块下的show方法";
     //echo "欢迎你".$_GET['name'];	//index.php?m=Index&a=show&name=tony
     //thinkphp/index.php/Index/show?name=Tim
     //thinkphp/index.php/Index/show/name/Tim
     echo "欢迎你".$_GET['name'].'你的年龄是'.$_GET['age'];
     //thinkphp/index.php/Index/show/name/Tony/age/18
     //改成横线连接模式Home/Conf/config.php
     //thinkphp/index.php/Index-show-name-Tony-age-18
     //普通模式
     //thinkphp/index.php/?m=Index&a=show&name=Tome&age=18
     //REWRITE模式 不要index.php 处于安全和搜索SEO考虑
     //如果想要开启REWRITE模式服务器必须支持REWRITE模式 Apache服务器配置文件搜索rewrite
     //thinkphp/Index/index .htaccess重写规则
     //兼容模式 服务器不支持PATHINFO方式 类似普通模式带问号
     //thinkphp/index.php?s=Index/index
     //thinkphp/?s=Index/index 开启了WEB服务器重写模式可以去掉index.php文件
   }
 }
 ?>
 config.php 配置项
 <?php
 return array(
   //'配置项'=>'配置值'
   'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
   
 );
 ?>
 index.php 入口文件
 <?php
   //1.确定应用名称 Home
   define('APP_NAME','Home');
   //2.确定应用路径
   define('APP_PATH','./Home/');
   //3.开启调试模式 默认为false
   define('APP_DEBUG',true);
   //4.应用核心文件
   require './ThinkPHP/ThinkPHP.php';
 ?>
 .htaccess重写文件
 <IfModule mod_rewrite.c>
  RewriteEngine on
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^(.*)$ index.php/$1 [QSA,PT,L]
 </IfModule>
  =========================================================================================
第三课大纲

#
 # ThinkPHP 3.1.2 输出和模型使用
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 
本节课大纲：


 
一、ThinkPHP 3 的输出      （重点）
  a、通过 echo 等PHP原生的输出方式在页面中输出
  b、通过display方法输出
  想分配变量可以使用assign方法
  c、修改左右定界符
  休要修改配置文件中的配置项
  'TMPL_L_DELIM'=>'<{', //修改左定界符
 
 'TMPL_R_DELIM'=>'}>', //修改右定界符


 
二、ThinkPHP 3 的模型使用  （重点）
  需要在方法中通过new Model（表名）的形式操作数据库
  $m=new Model('User');
  $arr=$m->select(); 
  'DB_TYPE'=>'mysql',   //设置数据库类型
  'DB_HOST'=>'localhost',//设置主机
  'DB_NAME'=>'thinkphp',//设置数据库名
  'DB_USER'=>'root',    //设置用户名
  'DB_PWD'=>'',        //设置密码
  'DB_PORT'=>'3306',   //设置端口号
  'DB_PREFIX'=>'tp_',  //设置表前缀
 
三、补充                   （了解）

第三课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符

第三课代码

IndexAction.class.php
 <?php
 //本类有系统自动生成，仅供测试用途
 class IndexAction extends Action{
   public function index(){
     //echo "Hello World!!";
     $m=new Model('User');
     $arr=$m->select();
     //var_dump($arr);
     //$name='赵子龙';
     //$this->assign('data',$name);
     $this->assign('data',$arr[0]['username']);
     $this->display();
   }
   public function show(){
     //echo "欢迎你".$_GET['name'].'你的年龄是'.$_GET['age'];
     $this->display();
   }
 }
 ?>
 index.html
 <html>
   <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Index</title>
   </head>
   <body>
     <h1>hello <{$data}></h1>
   </body>
 </html>
 config.php
 <?php
 return array(
   //'配置项'=>'配置值';
   'URL_PATHINFO_DEPR'=>'/',//修改URL的分隔符
   'TMPL_L_DELIM'=>'<{',    //修改左定界符
   'TMPL_R_DELIM'=>'}>',    //修改右定界符
   'DB_TYPE'=>'mysql',      //设置数据库类型
   'DB_HOST'=>'localhost',  //设置主机
   'DB_NAME'=>'thinkphp',   //设置数据库名
   'DB_USER'=>'root',       //设置用户名
   'DB_PWD'=>'',            //设置密码
   'DB_PORT'=>'3306',       //设置端口号
   'DB_PREFIX'=>'tp_',      //设置标签缀
 )
 ?>
 =========================================================================================
 第四课大纲

#
 # ThinkPHP 3.1.2 输出和模型使用
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 
本节课大纲：

一、ThinkPHP 3 的输出      （重点）
  a、通过 echo 等PHP原生的输出方式在页面中输出
  b、通过display方法输出
  想分配变量可以使用assign方法
  c、修改左右定界符
  休要修改配置文件中的配置项
  'TMPL_L_DELIM'=>'<{', //修改左定界符
  'TMPL_R_DELIM'=>'}>', //修改右定界符
 
二、ThinkPHP 3 的模型使用  （重点）
  需要在方法中通过new Model（表名）的形式操作数据库
  $m=new Model('User');
  $arr=$m->select(); 
  'DB_TYPE'=>'mysql',   //设置数据库类型
  'DB_HOST'=>'localhost',//设置主机
  'DB_NAME'=>'thinkphp',//设置数据库名
  'DB_USER'=>'root',    //设置用户名
  'DB_PWD'=>'',        //设置密码
  'DB_PORT'=>'3306',   //设置端口号
  'DB_PREFIX'=>'tp_',  //设置表前缀
  也可以使用DSN方法进行配置
  'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息	???
  如果两种方式同时存在，以DSN方式为优先
  还有一种简单实用模型的方式
  M() 等效为 new Model();
  $m=M('User');
 $arr=$m->select();
 
 使用模型的实例可以对数据进行操作，操作的工作一般就是对数据库进行 增删改查 CURD
  增 -C Create $m->add()
  删 -D Delete $m->delete()
  改 -U Update $m->save()
  查 -R Read   $m->select()

 
三、补充                   （了解）
  a、模板可以遍历数组
  <volist name='data' id='vo'>
  <{$vo.id}>----<{$vo.username}>-----<{$vo.sex}><br/>
  </volist>
  b、我们可以开启调试功能中的page_trace
  1.开启调试功能
  //3.开启调试模式
  define('APP_DEBUG',true);
  2.我们需要设置配置文件，开启页面trace
  'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 
第四课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace	???
 
第四课代码

index.html
 <html>
   <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Index</title>
   </head>
   <body>
     <volist name='data' id='vo'> //name是数组标识 vo代表数组
        <{$vo.id}>----<{$vo.username}>-----<{$vo.sex}><br/>
     </volist>
   </body>
 </html>
 IndexAction.class.php
 <?php
 //本类由系统自动生成，仅供测试用途
 class IndexAction extends Action{
   public function index(){
     //$m=new Model('User');
     $m=M('User');
     $arr=$m->select();
     //var_dump($arr);
     //$name='赵子龙';
     $this->assign('data',$arr);
     $this->display();
   }
   public function show(){
     $this->display();
   }
 }
 ?>
 config.php 传统方式和DSN方式同时存在 DSN生效
 <?php
 return array(
   //'配置项'=>'配置值'
   'URL_PATHINFO_DEPR'=>'/',//修改URL的分隔符
   'TMPL_L_DELIM'=>'<{', //修改左定界符
   'TMPL_R_DELIM'=>'}>', //修改右定界符
   //'DB_TYPE'=>'mysql',   //修改数据库类型
   //'DB_HOST'=>'localhost',//修改主机名
   //'DB_NAME'=>'thinkphp',//修改数据库名
   //'DB_USER'=>'root',    //修改用户名
   //'DB_PWD'=>'',         //修改密码
   //'DB_ROOT'=>'3306',     //修改端口号
   'DB_PREFIX'=>'tp_',   //设置标签缀
   'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
   'SHOW_PAGE_TRACE'=>'true',
 );
 ?>
=========================================================================================
第五课大纲

#
 # ThinkPHP 3.1.2 CURD特性
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、ThinkPHP 3 的CURD介绍  （了解）
 二、ThinkPHP 3 读取数据    （重点）
  对数据的读取 Read
  $m=new Model('User');
  $m=M('User');
  select
  $m->select();//获取所有数据，以数组形式返回
  find
  $m->find($id);//获取单条数据
  getField(字段名)//获取一个具体的字段值
  $arr=$m->where('id=2')->getField('username');
 三、ThinkPHP 3 创建数据    （重点）
  对数据的添加 Create
  $m=new Model('User');
  $m=M('User');
  $m->字段名=值
  $m->add();
  返回值是新增的id号
 四、ThinkPHP 3 删除数据    （重点）
  $m=M('User');
  $m->delete(2);               //删除id为2的数据
  $m->where('id=2')->delete(); //与上面效果相同，也是删除id为2的数据
  返回值是受影响行数
 五、ThinkPHP 3 更新数据    （重点）
  $m=M('User');
  $data['id']=1;
  $data['username']='ztz2';
  $m->save($data);             
  返回值是受影响行数
 
第五课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 
第五课代码

IndexAction.class.php
 <?php
 //本类有系统自动生成，仅供测试用途
 class IndexAction extends Action{
   public function index(){
     //echo "Hello World!!";
     //$m=new Model('User');
     $m=M('User');
     //$arr=$m->select();
     //$arr=$m->find();
     //$arr=$m->find(2);
     //$arr=$m->getField('username');
     //$arr=$m->where('id=2')->getField('username'); //连贯操作    
     //var_dump($arr);
     //$m->username='王二'
     //$m->username='李四';
     //$m->username='王五';
     //$m->delete(2); //代表id为2的 删除id为2的数据
     //$m->where('id=2')->delete(); //与上面效果相同，也是删除id为2的数据
     //$data['id']=1;
     //$data['username']='ztz2';
     //$data['username']='ztz3';
     //$count=$m->save($data);
     //echo $count; //返回值是受影响行数
     $m->username='gege';
     echo $m->add();
     //$m->sex=1;
     //$m->add();
     //$name='赵子龙';
     //$this->assign('data',$arr);
     $this->display(); //ShowPageTrace
   }
   public function show(){
     //echo "欢迎你".$_GET['name'].'你的年龄是'.$_GET['age'];
     $this->display();
   }
 }
 ?>
=========================================================================================
第六课大纲：
 一、ThinkPHP 3 的CURD管理用户信息  
 
第六课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 

第六课代码

UserAction.class.php
 <?php
   class UserAction extends Action{
     public function index(){
       $m=M('User');
       $arr=$m->select();
       //var_dump($arr);
       $this->assign('data',$arr);
       //echo "你好！";
       $this->display();
     }
     public function del(){
       $m=M('User');
       $id=$_GET['id'];
       $count=$m->delete($id);
       if($count>0){
         $this->success('数据删除成功');
       }else{
         $this->error('数据删除失败');
       }
     }
     public function modify(){
       $id=$_GET['id'];
       $m=M('User');
       $arr=$m->find($id);
       $this->assign('data',$arr);
       $this->display();
     } 
 

  }
 ?>
 User\index.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
   </head>
   <body>
      <table border='1' width="500" align="center">
         <tr>
               <th>id</th>
               <th>username</th>
               <th>sex</th>
       <th>操作</th>
         </tr>
         <volist name='data' id='vo'>
            <tr>
                <td><{$vo.id}></td>
                <td><{$vo.username}></td>
                <td><{$vo.sex}></td>
                <td><a href="/thinkphp/index.php/User/del/id/<{$vo.id}>">删除</a> | <a href="/thinkphp/index.php/User/modify/id/<{$vo.id}>">修改</td>
            </tr> 
         </volist>
      </table>
   </body>
 </html>
 User\modify.html
 <html>
   <head>
      <meta http-equiv="content-type" content="text/html;charset=utf-8">
      <title>Modify</title>
      <script>
        window.onload=function(){
          if(<{$data.sex}>==0){
            document.getElementsByName('sex')[1].checked='checked';
          }else{
            document.getElementsByName('sex')[0].checked='checked';
          }
        }
      </script>
   </head>
   <body>
      <form>
        姓名:<input type="text" name="username" value="<{$data.username}>"/><br/>
        性别:男<input type="radio" name="sex" value="1">女<input type="radio" name="sex" value="0"><br/>   
        <input type="submit" value="提交修改"/>
      </form>
   </body>
 </html>
=========================================================================================
第七课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace

第七课代码

UserAction.class.php
 <?php
   class UserAction extends Action{
     public function index(){
       $m=M('User');  //实例化数据表
       $arr=$m->select();//执行查询操作
       //var_dump($arr);
       $this->assign('data',$arr); //给数组赋标识符
       $this->display(); //调用模板页面
     }
     public function del(){
       $m=M('User');  //实例化数据表
       $id=$_GET['id'];  //接收传递参数
       $count=$m->delete($id); //执行删除操作
       if($count>0){  //判断受影响行数
         $this->success('数据删除成功'); //执行成功跳转
       }else{
         $this->error('数据删除失败');  //执行失败跳转
       }
     }
     /*
      *  显示修改页面
      **/
     public function modify(){
       $id=$_GET['id'];  //接收传递参数
       $m=M('User');  //实例化数据表
       $arr=$m->find($id);//执行查询操作
       $this->assign('data',$arr);//给数组赋标识符
       $this->display();  //调用模板页面
     }
     public function update(){
       $m=M('User');
       $data['id']=$_POST['id'];
       $data['username']=$_POST['username'];
       $data['sex']=$_POST['sex'];
       $count=$m->save($data);
       if($count>0){  //判断受影响行数
         $this->success('数据修改成功','index');//执行成功跳转首页
       }else{
         $this->error('数据修改失败');  //执行失败跳转
       }
     }
     /*
      *添加页面
      **/
      public function add(){
        $this->display();
      }
      public function create(){
        $m=M('User');  //实例化数据表
        $m->username=$_POST['username']; //接收传递参数
        $m->sex=$_POST['sex'];  //接收传递参数
        $idNum=$m->add();  //执行添加操作
        if($idNum>0){
          $this->success('数据添加成功','index');//执行成功跳转首页
        }else{
          $this->error('数据添加失败');  //执行失败跳转
        }
      }
   }
 ?>
 index.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html; charset=utf-8">
     <title>Index</title>
     <script>
  function jump(){
           window.location="/thinkphp/index.php/User/add";
         }
     </script>
   </head>
   <body>
     <table border='1' width='500' align='center'>
       <tr>
         <td>id</td>
         <td>username</td>
         <td>sex</td>
         <td>操作</td>
       </tr>
       <volist name='data' id='vo'>
          <tr>
            <td><{$vo.id}></td>
            <td><{$vo.username}></td>
            <td><{$vo.sex}></td>
            <td><a href="/thinkphp/index.php/User/del/id/<{$vo.id}>">删除</a> | <a href="/thinkphp/index.php/User/modify/id/<{$vo.id}>">修改</a></td>
          </tr>
       </volist>
     </table>
     <center>
     <button onclick="jump()">添加用户</button>
     </center>
   </body>
 </html>
 modify.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Modify</title>
     <script>
       window.onload=function(){
         if(<{$data.sex}>==0){
           document.getElementsByName('sex')[1].checked='checked';
         }else{
           document.getElementsByName('sex')[0].checked='checked';
         }
       }
     </script>
     <body>
       <form action="/Thinkphp/index.php/User/update" method='post'>
  <input type='hidden' name='id' value='<{$data.id}>'/>
         姓名:<input type='text' name='username' value='<{$data.username}>'/><br/>
         性别:男<input type='radio' name='sex' value='1'>女<input type="radio" name='sex' value='0'><br/>
         <input type='submit' value='提交修改'>
       </form>
     </body>
   </head>
 </html>
 add.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Add</title>
   </head>
   <body>
     <form action='__URL__/Create' method='post'>
       姓名:<input type="text" name="username"/><br>
       性别:男<input type="radio" name='sex' value='1'/>
            女<input type="radio" name='sex' value='0'><br/>
       <input type="submit" value="添加新用户">
     </form>
   </body>
 </html>
=========================================================================================
第八课大纲

#
 # ThinkPHP 3.1.2 查询方式
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、普通查询方式
  a、字符串
  $arr=$m->where("sex=0 and username='gege'")->find();
  b、数组
  $data['sex']=0;
  $data['username']='gege';
  $arr=$m->where($data)->find();
  注意：这种方式默认是and的关系，如果使用or关系，需要添加数组值
  $data['sex']=0;
  $data['username']='gege';
  $data['_logic']='or';
 二、表达式查询方式
  $data['id']=array('lt',6);
  $arr=$m->where($data)->select();
  EQ 等于
  NEQ不等于
  GT 大于
  EGT大于等于
  LT 小于
  ELT小于等于
  LIKE 模糊查询
  $data['username']=array('like','%ge');
  $arr=$m->where($data)->select();
  NOTLIKE
  $data['username']=array('notlike','%ge%'); //notlike中间没有空格
     $arr=$m->where($data)->select();
  注意：如果一个字段要匹配多个通配符
  $data['username']=array('like',array('%ge%','%2%','%五%'),'and');//如果没有第三个值，默认关系是or关系
  $arr=$m->where($data)->select();
  BETWEEN
  $data['id']=array('between',array(5,7));
  $arr=$m->where($data)->select();
  //SELECT * FROM `tp_user` WHERE ( (`id` BETWEEN 5 AND 7 ) )
  $data['id']=array('not between',array(5,7));//注意，not 和 between中间一定要有空格
  $arr=$m->where($data)->select();
  IN
  $data['id']=array('in',array(4,6,7));
  $arr=$m->where($data)->select();
  //SELECT * FROM `tp_user` WHERE ( `id` IN (4,6,7) )
  $data['id']=array('not in',array(4,6,7));
  $arr=$m->where($data)->select();
  //SELECT * FROM `tp_user` WHERE ( `id` NOT IN (4,6,7) )
 三、区间查询
 四、统计查询
 五、SQL直接查询
 
第八课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 

第八课代码

IndexAction.class.php 前台对数据的查询 后台对数据的增删改
 <?php
 //本类由系统自动生成,仅供测试用途
 class IndexAction extends Action{
   public function index(){
    //echo "Hello World!!";
    //$m=new Model('User');
    $m=M('User');
    //$arr=$m->select();
    //$arr=$m->find(2);
    //$arr=$m->where('id=2')->getField('username');
    //var_dump($arr);
    //$m->username='王五';
    //$m->sex=1;
    //$m->add();
    //$m->delete(2);
    //$m->where('id=3')->delete();
    //$data['id']=1;
    //$data['username']='ztz3';
    //$count=$m->save($data);
    //echo $count;
    $m->username='gege';
    echo $m->add();
    //$name='赵子龙';
    //$this->assign('data',$arr);
    $this->display();
   }
   public function show(){
    $m=M('User');
    //echo $m->where('id=18')->getField('username'); //where适用于getField find select
    //$data['sex']=0;
    //$data['username']='gege';
    //$data['_logic']='or';
    //$data['id']=array('GT',6);  //大于6
    //$data['id']=array('lt',18);   //小于18
    //$data['username']=array('like','%ge%'); //模糊查询
    //$data['username']=array('notlike','%ge%'); //notlike 中间没有空格
    //$data['username']=array('like',array('%ge%','%admin%')); //默认为or
    //$data['username']=array('like',array('%ge%','%ge%'),'and');
    //$data['id']=array('between',array(6,18)); //between 方式
    //$data['id']=array('not between',array(6,18)); //注意，not和between中间一定要有空格
    //$data['id']=array('in',array(6,9,18));
    //$data['id']=array('not in',array(6,9,18));
    //$arr=$m->where($data)->find(); //普通模式数组
    $arr=$m->where($data)->select();
    //$arr=$m->where('sex=0 and username="gege"')->find(); //普通模式字符串
    var_dump($arr);
    $this->display();
   }
 }
 ?>
 
=========================================================================================
第九课大纲

#
 # ThinkPHP 3.1.2 查询方式
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、普通查询方式
  a、字符串
  $arr=$m->where("sex=0 and username='gege'")->find();
  b、数组
  $data['sex']=0;
  $data['username']='gege';
  $arr=$m->where($data)->find();
  注意：这种方式默认是and的关系，如果使用or关系，需要添加数组值
  $data['sex']=0;
  $data['username']='gege';
  $data['_logic']='or';
 二、表达式查询方式
  $data['id']=array('lt',6);
  $arr=$m->where($data)->select();
  EQ 等于
  NEQ不等于
  GT 大于
  EGT大于等于
  LT 小于
  ELT小于等于
  LIKE 模糊查询
  $data['username']=array('like','%ge');
  $arr=$m->where($data)->select();
  NOTLIKE
  $data['username']=array('notlike','%ge%'); //notlike中间没有空格
     $arr=$m->where($data)->select();
  注意：如果一个字段要匹配多个通配符
  $data['username']=array('like',array('%ge%','%2%','%五%'),'and');//如果没有第三个值，默认关系是or关系
  $arr=$m->where($data)->select();
  BETWEEN
  $data['id']=array('between',array(5,7));
  $arr=$m->where($data)->select();
  //SELECT * FROM `tp_user` WHERE ( (`id` BETWEEN 5 AND 7 ) )
  $data['id']=array('not between',array(5,7));//注意，not 和 between中间一定要有空格
  $arr=$m->where($data)->select();
  IN
  $data['id']=array('in',array(4,6,7));
  $arr=$m->where($data)->select();
  //SELECT * FROM `tp_user` WHERE ( `id` IN (4,6,7) )
  $data['id']=array('not in',array(4,6,7));
  $arr=$m->where($data)->select();
  //SELECT * FROM `tp_user` WHERE ( `id` NOT IN (4,6,7) )
 三、区间查询
  $data['id']=array(array('gt',4),array('lt',10));//默认关系是 and 的关系
  //SELECT * FROM `tp_user` WHERE ( (`id` > 4) AND (`id` < 10) ) 
  $data['id']=array(array('gt',4),array('lt',10),'or') //关系就是or的关系
  $data['name']=array(array('like','%2%'),array('like','%五%'),'gege','or');
 四、统计查询
  count //获取个数
  max   //获取最大数
  min   //获取最小数
  avg   //获取平均数
  sum   //获取总和
 五、SQL直接查询
  a、query 主要数处理读取数据的
  成功返回数据的结果集
  失败返回boolean false
  $m=M();
  $result=$m->query("select *  from t_user where id >50");
  var_dump($result);
  b、execute 用于更新个写入操作
  成功返回影响行数
  失败返回boolean false
  $m=M();
  $result=$m->execute("insert into t_user(`username`) values('ztz3')");
  var_dump($result);
 
第九课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace


第九课代码 
IndexAction.class.php
 <?php
 //本类由系统自动生成,仅供测试用途
 class IndexAction extends Action{
   public function index(){
     //echo "Hello World!!";
     //$m=new Model('User');     //实例化数据表
     $m=M('User');  //实例化数据表
     //$arr=$m->select();        //执行查询操作
     //$arr=$m->find(2);  //执行查询操作
     //$arr=$m->where('id=2')->getField('username');  //查询id为2的username
     //var_dump($arr);  //打印数组
     //$m->username='王五';  //设定username为王五
     //$m->sex=1;  //设定sex为1
     //$m->add();  //执行添加操作
     //$m->delete(2);  //删除id为2的数据
     //$m->where('id=3')->delete(); //删除id为3的数据
     //$data['id']=1;  //设定id为1
     //$data['username']='ztz3'; //设定username为ztz3
     //$count=$m->save($data);  //修改数据
     //echo $count;  //返回受影响的行数
     $m->username='gege';
     echo $m->add();
     //$name='赵子龙';
     //$this->assign('data',$arr);
     $this->display();
   }
   public function show(){
     $m=M();
     //$result=$m->query("select * from tp_user where id>5");
     $result=$m->execute("insert into tp_user(`username`) values('ztz3')");
     var_dump($result);
     //$m=M('User');
     //$c=$m->count();
     //$c=$m->where("username='gege'")->count();
     //$data['username']='gege';
     //$c=$m->where($data)->count();
     //$c=$m->max('id');
     //$c=$m->min('id');
     //$c=$m->avg('id');
     //$c=$m->sum('id');
     //echo $c;
     //$data['username']=array('like',array('%ge%','&2&','%五%'),'and');
     //$data['id']=array('not in',array(4,6,7));
     //$data['id']=array(array('gt',4),array('lt',10));
     //$data['id']=array(array('gt',4),array('lt',10),'or');
     //$data['username']=array(array('like','%2%'),array('like','%五%'),'gege');
     //$data['username']=array(array('like','%2%'),array('like','%五%'),'gege','or');
     //$arr=$m->where($data)->select();
     //$arr=$m->where("sex=0 and username 'gege'")->find();
     //var_dump($arr);
     $this->display();
   }
 }
 ?>
 
=========================================================================================
第十课配置项

'URL_PATHINFO_DEPR' => '-' //配置Pathinfo模式访问的分割符
 'TMPL_L_DELIM'=>'<{';    //配置左定界符
 'TMPL_R_DELIM'=>'}>';    //配置右定界符
 'DB_TYPE'=>'mysql',     //设置数据可类型
 'DB_HOST'=>'localhost', //设置数据库主机
 'DB_NAME'=>'thinkphp',  //设置数据库名
 'DB_USER'=>'root',      //设置用户名
 'DB_PWD'=>'',           //设置密码
 'DB_PORT'=>'3306',      //设置端口号
 'DB_PREFIX'=>'tp_',     //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp', //DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'DB_LIKE_FIELDS'=>'title|content' //查询语句中条件自动变为模糊查询%%
 
第十课数据库 

-- phpMyAdmin SQL Dump
 -- version 3.5.1
 -- http://www.phpmyadmin.net
 --
 -- 主机: localhost
 -- 生成日期: 2013 年 03 月 26 日 14:34
 -- 服务器版本: 5.5.24-log
 -- PHP 版本: 5.3.13
 SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";
 SET time_zone = "+00:00";
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
 /*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
 /*!40101 SET NAMES utf8 */;
 --
 -- 数据库: `thinkphp`
 --
 -- --------------------------------------------------------
 --
 -- 表的结构 `tp_user`
 --
 CREATE TABLE IF NOT EXISTS `tp_user` (
   `id` int(11) NOT NULL AUTO_INCREMENT,
   `username` varchar(30) NOT NULL,
   `sex` tinyint(4) NOT NULL DEFAULT '1',
   PRIMARY KEY (`id`)
 ) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=25 ;
 --
 -- 转存表中的数据 `tp_user`
 --
 INSERT INTO `tp_user` (`id`, `username`, `sex`) VALUES
 (8, 'gege', 1),
 (7, 'gege', 1),
 (6, 'gege', 0),
 (4, '李四2', 1),
 (5, '王五', 1),
 (10, 'gege', 1),
 (11, 'gege', 1),
 (12, 'gege', 1),
 (13, 'ztz3', 1),
 (14, 'gege', 1),
 (15, 'gege', 1),
 (16, 'gege', 1),
 (17, 'gege', 1),
 (18, 'gege', 1),
 (19, 'gege', 1),
 (20, 'gege', 1),
 (21, 'gege', 1),
 (22, 'gege', 1),
 (23, 'gege', 1),
 (24, 'gege', 1);
 /*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
 /*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
 /*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;

第十课代码 

UserAction.class.php>>> 

<?php
  class UserAction extends Action{
  public function index(){
  $m=M('User');
  $arr=$m->select();
  //var_dump($arr);
  $this->assign('data',$arr);
  $this->display();
  }
  public function del(){
  $m=M('User');
  $id=$_GET['id'];
  $count=$m->delete($id);
  if($count>0){
  $this->success('数据删除成功');
  }else{
  $this->error('数据删除失败');
  }
  }
  /*
  *  显示修改页面
  * */
  public function modify(){
  $id=$_GET['id'];
  $m=M('User');
  $arr=$m->find($id);
  $this->assign('data',$arr);
  $this->display();
  }
  public function update(){
  $m=M('User');
  $data['id']=$_POST['id'];
  $data['username']=$_POST['username'];
  $data['sex']=$_POST['sex'];
  $count=$m->save($data);
  if($count>0){
  $this->success('数据修改成功','index');
  }else{
  $this->error('数据修改失败');
  }
  }
  /*
  * 添加页面
  * */
  public function add(){
  $this->display();
  }
  public function create(){
  $m=M('User');
  $m->username=$_POST['username'];
  $m->sex=$_POST['sex'];
  $idNum=$m->add();
  if($idNum>0){
  $this->success('数据添加成功','index');
  }else{
  $this->error('数据添加失败');
  }
  }
  //编写search方法，实现搜索
  public function search(){
  //获取post的数据，根据数据组装查询的条件，根据条件从数据库中获取数据，返回给页面中遍历
  if(isset($_POST['username']) && $_POST['username']!=null){
  $where['username']=array('like',"%{$_POST['username']}%");//双引号可以解析里面的变量
  }
  if(isset($_POST['sex']) && $_POST['sex']!=null){
  $where['sex']=array('eq',$_POST['sex']);
  }
  $m=M('User');
  $arr=$m->where($where)->select();
  $this->assign('data',$arr);
  $this->display('index');//给变量返回首页
  //var_dump($_POST);
  }
  }
 ?>
 
Tpl\User\index.html>>> 

<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Index</title>
  <script>
  function jump(){
  window.location="/thinkphp/index.php/User/add";
  }
  </script>
  <style>
  form {
  text-align:center;
  }
  </style>
  </head>
  <body>
  <form action='__URL__/search' method='post'>
  用户名:<input type='text' name='username'/>
  性别:<input type='radio' name='sex' value='1'/>男 <input type='radio' name='sex' value='0'/>女
  <input type='submit' value='搜索'/>
  </form>
  <table border='1' width="500" align='center'>
  <tr>
  <th>id</th>
  <th>username</th>
  <th>sex</th>
  <th>操作</th>
  </tr>
  <volist name='data' id='vo'>
  <tr>
  <td><{$vo.id}></td>
  <td><{$vo.username}></td>
  <td><{$vo.sex}></td>
  <td><a href="/thinkphp/index.php/User/del/id/<{$vo.id}>">删除</a> | <a href="/thinkphp/index.php/User/modify/id/<{$vo.id}>">修改</a></td>
  </tr>
  </volist>
  </table>
  <center>
  <button onclick="jump()">添加用户</button>
  </center>
  </body>
 
</html> 

Tpl\User\modify.html>>> 

<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Modify</title>
  <script>
  window.onload=function(){
  if(<{$data.sex}>==0){
  document.getElementsByName('sex')[1].checked='checked';
  }else{
  document.getElementsByName('sex')[0].checked='checked';
  }
  }
  </script>
  </head>
  <body>
  <form action="/Thinkphp/index.php/User/update" method='post'>
  <input type='hidden' name='id' value="<{$data.id}>"/>
  姓名:<input type="text" name='username' value="<{$data.username}>"/><br/>
  性别:男<input type='radio' name='sex' value='1' > 女<input type='radio' name='sex' value='0'/><br/>
  <input type="submit" value="提交修改"/>
  </form>
  </body>
 </html>
 
Tpl\User\add.html>>> 

<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Add</title>
  </head>
  <body>
  <form action='__URL__/create' method='post'>
  姓名:<input type="text" name="username"/><br/>
  性别：男<input type="radio" name='sex' value='1'/>
       女<input type='radio' name='sex' value='0'/><br/>
  <input type="submit" value='添加新用户'/>
  </form>
  </body>
 </html> 

=========================================================================================
第十一课大纲

#
 # ThinkPHP 3.1.2 连贯操作
 #
 本节课大纲：
 一、常用连贯操作  （重点）
 二、补充          （了解）
 ====================================================
 一、常用连贯操作
  1.where
  帮助我们设置查询条件
  2.order 
  对结果进行排序
  $arr=$m->order('id desc')->select();
  $arr=$m->order(array('id'=>'desc','sex'=>'asc'))->select();
  3.limit 
  限制结果
  limit(2,5)
  limit('2,5')
  limit(10)//limit(0,10)
  4.field 
  设置查询字段
  field('username as name,id')
  field(array('username'=>'name','id')
  field('id',true) //获取除了id以外的所有字段
  5.table 
  6.group 
  7.having
 二、补充  
  alias 用于给当前数据表定义别名 字符串 
  page 用于查询分页（内部会转换成limit） 字符串和数字 
  join* 用于对查询的join支持 字符串和数组 
  union* 用于对查询的union支持 字符串、数组和对象 
  distinct 用于查询的distinct支持 布尔值 
  lock 用于数据库的锁机制 布尔值 
  cache 用于查询缓存 支持多个参数（以后在缓存部分再详细描述） 
  relation 用于关联查询（需要关联模型扩展支持） 字符串 
  validate 用于数据自动验证 数组 
  auto 用于数据自动完成 数组 
  filter 用于数据过滤 字符串 
  scope* 用于命名范围 字符串、数组 
 
 补充部分会在以后在详细探讨

第十一课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace

第十一课代码

www\Model\Model.class.php
 <?php
   class Model{
     private $tabName=null;          //成员属性要准备好
     private $sql=null;
     private $where=null;
     function __construct($tabName){ //构造方法 $tabName形参
       $this->tabName=$tabName;      //成员属性等于形参
       mysql_connect('localhost','root',''); //mysql的主机 用户名和密码
       mysql_select_db('thinkphp');  //选择数据库
     }
     function where($_where){
       $this->where=$_where;
       return $this; //this代表对象本身 返回自己
     }
     function select(){
       $arr=array();                 
       //$sql="select * from tp_User"; //执行sql语句     
       //$this->sql="select * from tp_".strtolower($this->tabName);  //User从成员属性里面拿 strtolower变为小邪恶
       $this->sql="select * from tp_".strtolower($this->tabName)." where {$this->where}";
       $result=mysql_query($this->sql);    //如果sql语句是select语句会返回一个结果集
       if($result && mysql_num_rows($result)>0){ //判断有没有结果集并且结果集里面有内容 返回结果集行数
           while($res=mysql_fetch_assoc($result)){  //将表里的每一行数据返回给变量
             $arr[]=$res;
           }      
       }
       return $arr;
     }
     function getSql(){
       return $this->sql;
     }
   }
   function M($tabName){
       return new Model($tabName);
   }
   $m=M('User');
   //$m=new Model('User'); //$m是一个对象
   //$m2=$m->where('id>10'); //标识变量m2就是本对象
   //$arr=$m2->select();//成员属性存储在内存中
   $arr=$m->where('id > 10')->select(); //$m->where('id > 10')这是一个对象 对象当然可以调用select方法
   var_dump($arr);
   echo "<br/>";
   echo $m->getSql();
 ?>
 UserAction.class.php
 public function demo(){
   $m=M('User');
   //$arr=$m->order('id asc')->select();
   //$arr=$m->order(array('id'=>'desc','sex'=>'asc'))-select();
   //$arr=$m->order(array('id'=>'desc','sex'=>'asc'))->limit(6)->select();
   //$arr=$m->order(array('id'=>'desc','sex'=>'asc'))->limit(3,3)->select(); //orderby和limit没有前后顺序之分
   //$arr=$m->limit(2,5)->order(array('id'=>'desc','sex'=>'asc'))->field('username')->select();
   //$arr=$m->limit(2,5)->order(array('id'=>'desc','sex'=>'asc'))->field('username,id')->select();
   //$arr=$m->limit(2,5)->order(array('id'=>'desc','sex'=>'asc'))->field('username as name,id')->select();
   //$arr=$m->limit(2,5)->order(array('id'=>'desc','sex'=>'asc'))->field(array('username','id'))->select();
   //$arr=$m->limit(2,5)->order(array('id'=>'desc','sex'=>'asc'))->field(array('username'=>'name','id'))->select();
   $arr=$m->limit(2,5)->order(array('id'=>'desc','sex'=>'asc'))->field('id',true)->select(); //获取除了id以外的所有字段
   $this->show('abc'); //显示abc 没有模板文件
 }
 
=========================================================================================
第十二课大纲

#
 # ThinkPHP 3.1.2 视图
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、模板的使用        （重点）
  a、规则
  模板文件夹下[TPL]/[分组文件夹/][模板主题文件夹/]和模块名同名的文件夹[Index]/和方法名同名的文件[index].html（.tpl）
  更换模板文件的后缀名（修改配置文件）
  'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
  b、修改模板文件目录层次
  'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
  c、模板主题
  'DEFAULT_THEME'=>'your',//设置默认模板主题
  需要在TPL下面新建一个your文件夹作为模板主题文件夹
  如何动态修改模板主题？
  1、在后台准备一个功能，修改config.php文件中的默认模板项
  2、通过url传递 t=主题 参数可以修改不同的模板
  'DEFAULT_THEME'=>'your',//设置默认模板主题
  'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
  'THEME_LIST'=>'your,my',//支持的模板主题列表
 二、输出模板内容      （重点）
  a、display
  1.display中没有参数
  $this->display();
  2.可以带参数
  $this->display(本模块文件夹下的其他模板文件);
  $this->display('index2');
  $this->display(其他文件夹下的模板文件);
  $this->display('Public:error');//注意，仅仅需要在Tpl下有Public文件夹以及其中的error.html即可，不需要一定有Public模块
  $this->display(其他主题下的 文件夹下的 模板文件);//需要开启主题支持
  $this->display('my:Index:index');
 三、模板中的赋值      （重点）
 
四、模板替换          （重点）


第十二课代码

新建一个和模块名同名的文件夹 一个和方法名同名的html文件
 configure.php
 <?php
 return array(
   //'配置项'=>'配置值'
   'URL_PATHINFO_DEPR'=>'/', //修改URL的分隔符
   'TMPL_L_DELIM'=>'<{', //修改左定界符
   'TMPL_R_DELIM'=>'}>', //修改右定界符
   //'DB_TYPE'=>'mysql',   //设置数据库类型
   //'DB_HOST'=>'localhost', //设置主机
   //'DB_NAME'=>'thinkphp', //设置数据库名
   //'DB_USER'=>'root',     //设置用户名
   //'DB_PWD'=>'',          //设置密码
   //'DB_PORT'=>'3306',     //设置端口号
   'DB_PREFIX'=>'tp_',      //设置标前缀
   'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DNS方式配置数据库信息
   'SHOW_PAGE_TRACE'=>true,//开启页面Trace
   //'TMPL_TEMPLATE_SUFFIX'=>'.tpl', //默认为html 更改模板文件后缀名
   'TMPL_TEMPLATE_SUFFIX'=>'.html',
   //'TMPL_FILE_DERP'=>'_',   //修改模板文件目录层次
   //'DEFAULT_THEME'=>'my',   //设置默认模板主题
   //'DEFAULT_THEME'=>'your',   //需要在TPL下面新建一个your文件夹作为主题文件夹  
   //'TMPL_DETECT_THEME'=>true, //默认为false 自动侦测模板主题
   //'THEME_LIST'='your,my',    //支持的模板主题列表
 )
 ?>
 Home\Tpl\Index_index.html
 <html>
   <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Index</title>
   </head>
   <body>
      新的模板文件
   </body>
 </html>
 /thinkphp/index.php/Index/index?t=my /thinkphp/index.php/Index/index/t/my
 /thinkphp/index.php/Index/index?t=your /thinkphp/index.php/Index/index/t/your
 Home\Tpl\Index\index2.html
 <html>
   <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Index</title>
   </head>
   <body>
      <h1>访问Index2模板文件</h1>
   </body>
 </html>
 IndexAction.class.php
 <?php
 class IndexAction extends Action{
   public function index(){
     //$this->display('index2'); //index2要求在Index模块或者Index文件夹下面才可以
     //$this->display('User:test');//寻找其它模块下的模板文件 找User文件夹下面的test.html文件
     $this->display('Public:error');//注意，仅仅需要在Tpl下有Public文件夹以及其中的error.html即可，不需要一定有public模块
     $this->display('my:Index:index');//开启其它主题下的 文件夹下的 模板文件 需要开启主题支持
   }
 }
 ?>
 Home\Tpl\User\test.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html; charset=utf-8">
     <title>Test</title>
   </head>
   <body>
     <h1>User/test.html</h1>
   </body>
 </html>
 
=========================================================================================
第十三课大纲

#
 # ThinkPHP 3.1.2 视图
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、模板的使用        （重点）
  a、规则
  模板文件夹下[TPL]/[分组文件夹/][模板主题文件夹/]和模块名同名的文件夹[Index]/和方法名同名的文件[index].html（.tpl）
  更换模板文件的后缀名（修改配置文件）
  'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
  b、修改模板文件目录层次
  'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
  c、模板主题
  'DEFAULT_THEME'=>'your',//设置默认模板主题
  需要在TPL下面新建一个your文件夹作为模板主题文件夹
  如何动态修改模板主题？
  1、在后台准备一个功能，修改config.php文件中的默认模板项
  2、通过url传递 t=主题 参数可以修改不同的模板
  'DEFAULT_THEME'=>'your',//设置默认模板主题
  'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 
 'THEME_LIST'=>'your,my',//支持的模板主题列表


 
二、输出模板内容      （重点）
  a、display
  1.display中没有参数
  $this->display();
  2.可以带参数
  $this->display(本模块文件夹下的其他模板文件);
  $this->display('index2');
  $this->display(其他文件夹下的模板文件);
  $this->display('Public:error');//注意，仅仅需要在Tpl下有Public文件夹以及其中的error.html即可，不需要一定有Public模块
  $this->display(其他主题下的 文件夹下的 模板文件);//需要开启主题支持
  $this->display('my:Index:index');
  $this->display(一个url路径);
  $this->display('./Public/error.html');
  $this->display('./Public/error.html','utf-8','text/xml');
  $this->show($content);
  3.fetch方法
  获得模板文件中的内容，以字符串形式返回
  $content=$this->fetch('Public:error');
  4.show方法
  不需要模板文件，可以直接输出模板内容
  $content=$this->fetch('Public:error');
  dump($content);
  $content=str_replace('h1','i',$content);
  $this->show($content);
 三、模板中的赋值      （重点）
  //$this->assign('name','赵桐正');
  $this->name='赵桐正2';
  $this->display();
 四、模板替换          （重点）
 __PUBLIC__：会被替换成当前网站的公共目录 通常是 /Public/
 __ROOT__： 会替换成当前网站的地址（不含域名） 
 __APP__： 会替换成当前项目的URL地址 （不含域名）
 __GROUP__：会替换成当前分组的URL地址 （不含域名）
 __URL__： 会替换成当前模块的URL地址（不含域名）
 __ACTION__：会替换成当前操作的URL地址 （不含域名）
 __SELF__： 会替换成当前的页面URL
  更换模板变量规则，修改配置项
  'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
  ),
 
第十三课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),


第十三课代码

config.php
 <?php
 return array(
   //'配置项'=>'配置值'
   'URL_PATHINFO_DEPR'=>'/', //修改URL的分隔符
   'TMPL_L_DELIM'=>'<{', //修改左定界符
   'TMPL_R_DELIM'=>'}>', //修改右定界符
   //'DB_TYPE'=>'mysql',   //设置数据库类型
   //'DB_HOST'=>'localhost', //设置主机
   //'DB_NAME'=>'thinkphp', //设置数据库名
   //'DB_USER'=>'root',     //设置用户名
   //'DB_PWD'=>'',          //设置密码
   //'DB_PORT'=>'3306',     //设置端口号
   'DB_PREFIX'=>'tp_',      //设置标前缀
   'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DNS方式配置数据库信息
   'SHOW_PAGE_TRACE'=>true,//开启页面Trace
   //'TMPL_TEMPLATE_SUFFIX'=>'.tpl', //默认为html 更改模板文件后缀名
   'TMPL_TEMPLATE_SUFFIX'=>'.html',
   //'TMPL_FILE_DERP'=>'_',   //修改模板文件目录层次
   //'DEFAULT_THEME'=>'my',   //设置默认模板主题
   //'DEFAULT_THEME'=>'your',   //需要在TPL下面新建一个your文件夹作为主题文件夹  
   //'TMPL_DETECT_THEME'=>true, //默认为false 自动侦测模板主题
   //'THEME_LIST'='your,my',    //支持的模板主题列表
    //'TMPL_PARSE_STRING'=>array( //添加自己的模板规则
    //'__CSS__'=>'/thinkphp/Public/Css',
    //'__JS__'=>'/thinkphp/Public/Js',
    //),
    'TMPL_PARSE_STRING'=>array( //添加自己的模板规则
    '__CSS__'=>__ROOT__.'/Public/Css',
    '__JS__'=>__ROOT__.'/Public/Js',
    ),
 )
 ?>
 IndexAction.class.php
 <?php
 class IndexAction extends Action{
   public function index(){
     //$this->display('./Public/error.html','utf-8'); //当前主入口文件的前
     //$this->display('./Public/error.html','utf-8','text/xml');
     //$this->show('<b>这里实现了加粗的字体</b>'); //show里面往往准备了变量
     //$content=$this->fetch('Public:error'); //通过fetch方法可以获取一个模板文件把内容转换成一个字符串
     //dump($content);
     //$content=str_replace('h1','i',$content);
     //$this->show($content);
     //$this->assign('name','赵子龙');
     $this->name='赵子龙2'
     $this->display();
   }
 }
 ?>
 \thinkphp\Public\error.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html; charset=utf-8">
     <title>Test</title>
   </head>
   <body>
     <h1>输出错误信息</h1>
   </body>
 </html>
 \Home\Tpl\Index\index.html
 <html>
   <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Index</title>
      //<link rel='stylesheet' type='text/css' href='__PUBLIC__/Css/basic.css'/>
      <link rel='stylesheet' type='text/css' href='__CSS__/basic.css'/>
      //<script src='__PUBLIC__/Js/basic.js'></script>
      <script src='__JS__/basic.js'></script>
   </head>
   <body>
      <p>hello <{$name}></p>
   </body>
 </html>
=========================================================================================
第十四课大纲

#
 # ThinkPHP 3.1.2 视图
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、模板的使用        （重点）
  a、规则
  模板文件夹下[TPL]/[分组文件夹/][模板主题文件夹/]和模块名同名的文件夹[Index]/和方法名同名的文件[index].html（.tpl）
  更换模板文件的后缀名（修改配置文件）
  'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
  b、修改模板文件目录层次
  'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
  c、模板主题
  'DEFAULT_THEME'=>'your',//设置默认模板主题
  需要在TPL下面新建一个your文件夹作为模板主题文件夹
  如何动态修改模板主题？
  1、在后台准备一个功能，修改config.php文件中的默认模板项
  2、通过url传递 t=主题 参数可以修改不同的模板
  'DEFAULT_THEME'=>'your',//设置默认模板主题
  'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
  'THEME_LIST'=>'your,my',//支持的模板主题列表
 二、输出模板内容      （重点）
  a、display
  1.display中没有参数
  $this->display();
  2.可以带参数
  $this->display(本模块文件夹下的其他模板文件);
  $this->display('index2');
  $this->display(其他文件夹下的模板文件);
  $this->display('Public:error');//注意，仅仅需要在Tpl下有Public文件夹以及其中的error.html即可，不需要一定有Public模块
  $this->display(其他主题下的 文件夹下的 模板文件);//需要开启主题支持
  $this->display('my:Index:index');
  $this->display(一个url路径);
  $this->display('./Public/error.html');
  $this->display('./Public/error.html','utf-8','text/xml');
  $this->show($content);
  3.fetch方法
  获得模板文件中的内容，以字符串形式返回
  $content=$this->fetch('Public:error');
  4.show方法
  不需要模板文件，可以直接输出模板内容
  $content=$this->fetch('Public:error');
  dump($content);
  $content=str_replace('h1','i',$content);
  $this->show($content);
 三、模板中的赋值      （重点）
  //$this->assign('name','赵桐正');
  $this->name='赵桐正2';
  $this->display();
 四、模板替换          （重点）
 __PUBLIC__：会被替换成当前网站的公共目录 通常是 /Public/
 __ROOT__： 会替换成当前网站的地址（不含域名） 
 __APP__： 会替换成当前项目的URL地址 （不含域名）
 __GROUP__：会替换成当前分组的URL地址 （不含域名）
 __URL__： 会替换成当前模块的URL地址（不含域名）
 __ACTION__：会替换成当前操作的URL地址 （不含域名）
 __SELF__： 会替换成当前的页面URL
  更换模板变量规则，修改配置项
  'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 
 ),

LoginAction.class.php

<?php
  class LoginAction extends Action {
  function index(){
  $this->display();
  }
  function do_login(){
  //获取用户名和密码等。和数据库中比对，有该用户允许登录否则输出错误页面
  $username=$_POST['username'];
  $password=$_POST['password'];
  $code=$_POST['code'];
  if($_SESSION['verify']!==md5($code)){
  $this->error('验证码错误！');
  }
  $m=M('User');
  $where['username']=$username;
  $where['password']=$password;
  $i=$m->where($where)->count();
  if($i>0){
  $this->redirect('User/index');
  }else{
  $this->error('该用户不存在');
  }
  }
  }
 ?>
 
Login\index.html

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Index</title>
  <link rel='stylesheet' type='text/css' href='__CSS__/basic.css'/>
  <script src="__JS__/basic.js"></script>
  </head>
  <body>
  <form action='__URL__/do_login' method='post' name='myForm'>
  用户名:<input type='text' name='username'/><br/>
  密　码:<input type='password' name='password'/><br/>
  验证码:<input type='text' name='code'/>
  <img src="__APP__/Public/code" onclick='this.src=this.src+"?"+Math.random()'/>
  </br/>
  <img src='__PUBLIC__/Images/login.gif' onclick="sub()"/>
  </form>
  </body>
 </html>
 
Public\Css\basic.css\ 

i  * {
  padding:0;
  margin:0;
  }
 form {
  width:300px;
  margin:0 auto;
  margin-top:50px;
  }
 
Public\Js\basic.js

function sub(){
  var ou=document.myForm.username;
  var op=document.myForm.password;
  var oc=document.myForm.code;
  if(ou.value=='' || op.value=='' ||oc.value==''){
  alert('用户名或者密码或者验证码不能为空');
  }else{
  document.myForm.submit();
  }
  }
 
PublicAction.class.php 
<?php
  class PublicAction extends Action{
  function code(){
  import('ORG.Util.Image');
      Image::buildImageVerify();
  }
  }
 ?> 
第十四课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 
第十四课sql

-- phpMyAdmin SQL Dump
 -- version 3.5.1
 -- http://www.phpmyadmin.net
 --
 -- 主机: localhost
 -- 生成日期: 2013 年 03 月 24 日 22:52
 -- 服务器版本: 5.5.24-log
 -- PHP 版本: 5.3.13
 SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";
 SET time_zone = "+00:00";
 /*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
 /*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
 /*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
 /*!40101 SET NAMES utf8 */;
 --
 -- 数据库: `thinkphp`
 --
 -- --------------------------------------------------------
 --
 -- 表的结构 `tp_user`
 --
 CREATE TABLE IF NOT EXISTS `tp_user` (
   `id` int(11) NOT NULL AUTO_INCREMENT,
   `username` varchar(30) NOT NULL,
   `password` char(32) NOT NULL,
   `sex` tinyint(4) NOT NULL DEFAULT '1',
   PRIMARY KEY (`id`)
 ) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=33 ;
 --
 -- 转存表中的数据 `tp_user`
 --
 INSERT INTO `tp_user` (`id`, `username`, `password`, `sex`) VALUES
 (8, 'gege', '', 1),
 (7, 'gege', '', 1),
 (6, 'gege', '', 0),
 (4, '李四2', '', 1),
 (5, '王五', '', 1),
 (10, 'gege', '', 1),
 (11, 'gege', '', 1),
 (12, 'gege', '', 1),
 (13, 'ztz3', '', 1),
 (14, 'gege', '', 1),
 (15, 'gege', '', 1),
 (16, 'gege', '', 1),
 (17, 'gege', '', 1),
 (18, 'gege', '', 1),
 (19, 'gege', '', 1),
 (20, 'gege', '', 1),
 (21, 'gege', '', 1),
 (22, 'gege', '', 1),
 (23, 'gege', '', 1),
 (24, 'gege', '', 1),
 (25, 'gege', '', 1),
 (26, 'gege', '', 1),
 (27, 'gege', '', 1),
 (28, 'gege', '', 1),
 (29, 'gege', '', 1),
 (30, 'gege', '', 1),
 (31, 'gege', '', 1),
 (32, 'tony', '123', 1);
 /*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
 /*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
 
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;

第十四课代码

LoginAction.class.php
 <?php
   class LoginAction extends Action{
     function index(){
       $this->display();
     }
     function do_login(){
         //获取用户名和密码等。和数据库中比对，有该用户允许登陆否则输出错误页面
         //dump($_POST);    //输出提交信息
  //dump($_SESSION); //输出验证码
        $username=$_POST['username'];
        $password=$_POST['password'];
        $code=$_POST['code'];
        if($_SESSION['verify']!==md5($code)){
            $this->error('验证码错误！');
        }
        $m=M('User');
        $where['username']=$username;
        $where['password']=$password;
        $i=$m->where($where)->count();
        if($i>0){
            $this->redirect('User/index');
        }else{
            $this->error('该用户不存在');
        }
     }
   }
 ?>
 Login\index.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
     <link rel='stylesheet'type='text/css' href='__PUBLIC__/Css/Basic.css'/>
     <script src='__PUBLIC__/Js/basic.js'></script>
     <script>
         function sub(){
           var ou = document.myForm.username;    
           var op = document.myForm.password;    
           var oc = document.myForm.code;
           if(ou.value=='' || op.value=='' || oc.value==''){
               alert('用户名或者密码或者验证码为空');            
           }else{
               document.myForm.submit();
           }
         }
     </script>
   </head>
   <body>
     <form action='__URL__/do_login' method='post' name='myForm'>
        用户名：<input type='text' name='username'/><br/>
        密码：<input type='password' name='password'/><br/>
        验证码：<input type='text' name='code'/>
                <img src="__APP__/Public/Code" onclick='this.src=this.src+"?"+Math.Random'></br/>
        //<input type='submit' value='提交'>
        <img src='__PUBLIC__/images/login.gif' onclick="sub()"/>
     </form>
   </body>
 </html>
 PublicAction.class.php
 <?php
   class PublicAction extends Action{
     function code(){
       import('ORG.Util.Image');
       Image::buildImageVerify();
     }
   }
 ?>
=========================================================================================
第十五课大纲

#
 # ThinkPHP 3.1.2 模板中的变量
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、变量输出        （重点）
  1.标量输出
  2.数组输出
  {$name[1]}
  {$name['k2']}
  {$name.k1}
  3.对象输出
  {$name:k}
  {$name->k}
 二、系统变量
  {$Think.get.id}
 三、使用函数
  {$name|strtoupper} 生成的编译后文件是 <?php echo (strtoupper($name)); ?>
  {$name|date='Y m d H:i:s',###}
 四、默认值
  {$name|default='这里是默认值'}
 五、运算符
  + - * / % ++ --
 
 {$name++}

第十五课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),

第十五代码

IndexAction.class.php
 <?php
 //本类有系统自动生成，仅供测试用途
 class IndexAction extends Action{
    public function index(){
      //$arr=array('赵桐正','赵桐正2');
      //$arr=array('k1'=>'赵桐正1','k2'=>'赵桐正2');
      //$this->assign('name','赵桐正');
      $n=$_GET['name'];
      //import('ORG.MY.Test');
      //$obj=new Test;
      //$this->assign('$data',$obj);
      //$this->assign('name',$arr);
      //$this->assign('name',$n);
      $this->assign('name',10);
      $this->assign('name','abc');
      $this->assign('name',time());
      $this->display();
    }
 }
 ?>
 Index.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html; charset=utf-8">
     <title>Index</title>
   </head>
   <body>
     {$name} //模板变量 变量值由后台分配来的
     {$name[1]}
     {$name['k2']}
     {$name.k2}
     {$name:k} //用冒号获取成员属性
     {$name->k}
     {$Think.get.name}
     {$Think.const.APP_NAME}
     {$name|md5}  <?php echo (md5($data)); ?>
     {$name|strtoupper}  <?php echo (strtoupper($data)); ?>
     {$name|date='Y m d H:i:s',###} <?php echo (date('Y m d H:i:s',$data)); ?>
     {$name|defalut='默认值'}
     {$name++}
   </body>
 </html>
 \www\thinkphp2\ThinkPHP\Extend\Library\ORG\my\Test.class.php
 <?php
   class Test{
     public $k='赵桐正！！';
   }
 ?>
=========================================================================================
第十六课大纲

#
 # ThinkPHP 3.1.2 模板中的基本语法
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、导入CSS和JS文件       
  1、css link
    js  scr
  <link rel='stylesheet' type='text/css' href='__PUBLIC__/Css/test.css'/>
  <script src='__PUBLIC__/Js/test.js'></script>
  2.import
  <import type='js' file='Js.test' /> //导入Public文件夹下面的Js目录中的test.js文件，import标签可以省略type属性，默认就是js的
  <import type='css' file='Css.test' />
  //可以更改默认文件夹 设置basepath属性
  <import type='js' file='Js.my' basepath='./Other'/>
  3.load
  //方法可以自动检测导入的文件类型
  <load href='__PUBLIC__/Js/test.js' />
 二、分支结构
  1、if 
  <if condition='$sex eq "男"'>
  男人是泥巴做的
  <else />
  女人是水做的
  </if>
  <if condition='$age lt 18'>
  未成年
  <elseif  condition='$age eq 18'/>
  青春年少
  <else />
  成年
  </if>
  >  gt
  <  lt
  == eq
  <= elt
  >= egt
  != neq
  === heq
  !== nheq
  <switch name='number'>
  <case value='1'>一个和尚挑水吃</case>
  <case value='2'>两个和尚台水吃</case>
  <case value='3'>三个和尚没水吃</case>
  <default/> 这里是默认值
  </switch>
 三、循环结构
 四、特殊标签
 五、其他标签使用 
 
第十六课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),


第十六课代码

index.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
     <!--<link rel='stylesheet' type='text/css' href='__PUBLIC__/Css/test.css'>-->
     <!--<script src='__PUBLIC__/Js/test.js'></script>-->
     <!--<import type='js' file='Js.test'/>-->
     <!--<import file='JS.test'/>-->
     <!--<import type='css' file='Css.test'/>-->
     <!--<import type='css' file='Css.my' basepath='./Other'/>-->
     <!--<import type='js' file='Js.my' basepath='./Other' />-->
     <!--<load href='__PUBLIC__/Css/test.css'/>-->
     <!--<load href='__PUBLIC__/Js/test.js'/>-->
   </head>
   <body>
     <p>{$name}</p>
     <!--<if condition='$sex eq "男"'>
       男人是泥巴做的
       <else/>
       女人是水做的
     </if>-->
     <if condition='$age lt 18'>
  未成年
       <elseif condition='$age eq 18'/>
         青春年少
       <else />
         成年
     </if>
     <switch name='number'>
       <case value='1'>一个和尚挑水吃</case>
       <case value='2'>两个和尚抬水吃</case>
       <case value='3'>三个和尚没水吃</case>
       <default/> 这里是默认值
     </switch>
   </body>
 </html>
 IndexAction.class.php
 <?php
  class IndexAction extends Action{
   public function index(){
     //$this->assign('sex','男');
     //$this->assign('age',20);
     $this->assign('number',3);
     $this->display();
   }
  }
 ?>
=========================================================================================
第十七课大纲

#
 # ThinkPHP 3.1.2 模板中的基本语法
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 

本节课大纲：
 一、导入CSS和JS文件       
  1、css link
    js  scr
  <link rel='stylesheet' type='text/css' href='__PUBLIC__/Css/test.css'/>
  <script src='__PUBLIC__/Js/test.js'></script>
  2.import
  <import type='js' file='Js.test' /> //导入Public文件夹下面的Js目录中的test.js文件，import标签可以省略type属性，默认就是js的
  <import type='css' file='Css.test' />
  //可以更改默认文件夹 设置basepath属性
  <import type='js' file='Js.my' basepath='./Other'/>
  3.load
  //方法可以自动检测导入的文件类型
  <load href='__PUBLIC__/Js/test.js' />
 二、分支结构
  1、if 
  <if condition='$sex eq "男"'>
  男人是泥巴做的
  <else />
  女人是水做的
  </if>
 

 <if condition='$age lt 18'>
  未成年
  <elseif  condition='$age eq 18'/>
  青春年少
  <else />
  成年
  </if>
  >  gt
  <  lt
  == eq
  <= elt
  >= egt
  != neq
  === heq
  !== nheq
  <switch name='number'>
  <case value='1'>一个和尚挑水吃</case>
  <case value='2'>两个和尚台水吃</case>
  <case value='3'>三个和尚没水吃</case>
  <default/> 这里是默认值
  </switch>
 三、循环结构
  1.for
  <table border='1' width='500'>
  <for start='10' end='00' name='j' step='-2' comparison='gt'>
  <tr><td>{$j}</td><td>abc</td></tr>
  </for>
  </table>
  2.volist
  <volist name='list' id='v'>
  {$v.username}<br/>
  </volist>
  3.foreach
  <foreach name='list' item='v' key='k'>
  {$k}-------{$v}<br/>
  </foreach>
 四、特殊标签
 五、其他标签使用 
 
第十七课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),


第十七课代码

Index.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
   </head>
   <body>
     <!--<table border='1' width='500'>
         <!--<for start='0' end='10' name='j' step='2' comparison='lt'>-->
         <for start='10' end='0' name='j' step='-2' comparison='gt'>
           <tr><td>{$j}</td><td>abc</td></tr>
         </for>    
     </table>-->
     <!--<volist name='list' id='v' offset='1' length='3'>-->
     <!--<volist name='list' id='v'>
        {$v}<br/>
        {$v.username}<br/>
     </volist>-->
     <!--<foreach name='list' item='v' key='k'>
  {$k}---{$v}<br>
     </foreach>-->
     <table border='1' width='500'>
       <foreach name='list' item='v'>
         <tr>
           <td>{$v.id}</td>
           <td>{$v.username}</td>
           <td>{$v.password}</td>
           <if condition="$v.sex eq 1">
              <td>男</td>
              <else/>
              <td>女</td>
           </if>
         </tr>
       </foreach>
     </table>
   </body>
 </html>
 IndexAction.class.php
 <?php
 class IndexAction extends Action{
   public function index(){
     $user=M('user');
     $arr=$user->select();
     //dump($arr);
     //$arr=array('k1'=>'v1','k2'=>'v2','k3'=>'v3');
     //$arr=array('a1','b2','c3','d4','e5','f6');
     //$arr[0]=array('id'=>1,'username'=>'ztz');
     //$arr[1]=array('id'=>2,'username'=>'ztz2');
     $this->assign('list',$arr);
     $this->display();
   }
 }
 ?>
 
=========================================================================================
第十八课大纲

#
 # ThinkPHP 3.1.2 模板中的基本语法
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、导入CSS和JS文件       
  1、css link
    js  scr
  <link rel='stylesheet' type='text/css' href='__PUBLIC__/Css/test.css'/>
  <script src='__PUBLIC__/Js/test.js'></script>
  2.import
  <import type='js' file='Js.test' /> //导入Public文件夹下面的Js目录中的test.js文件，import标签可以省略type属性，默认就是js的
  <import type='css' file='Css.test' />
  //可以更改默认文件夹 设置basepath属性
  <import type='js' file='Js.my' basepath='./Other'/>
  3.load
  //方法可以自动检测导入的文件类型
  <load href='__PUBLIC__/Js/test.js' />
 二、分支结构
  1、if 
  <if condition='$sex eq "男"'>
  男人是泥巴做的
  <else />
  女人是水做的
  </if>
  <if condition='$age lt 18'>
  未成年
  <elseif  condition='$age eq 18'/>
  青春年少
  <else />
  成年
  </if>
  >  gt
  <  lt
  == eq
  <= elt
  >= egt
  != neq
  === heq
  !== nheq
  <switch name='number'>
  <case value='1'>一个和尚挑水吃</case>
  <case value='2'>两个和尚台水吃</case>
  <case value='3'>三个和尚没水吃</case>
  <default/> 这里是默认值
  </switch>
 三、循环结构
  1.for
  <table border='1' width='500'>
  <for start='10' end='00' name='j' step='-2' comparison='gt'>
  <tr><td>{$j}</td><td>abc</td></tr>
  </for>
  </table>
  2.volist
  <volist name='list' id='v'>
  {$v.username}<br/>
  </volist>
  3.foreach
  <foreach name='list' item='v' key='k'>
  {$k}-------{$v}<br/>
  </foreach>
 四、特殊标签
  1、比较标签
  eq或者 equal 等于 
  neq 或者notequal 不等于 
  gt 大于 
  egt 大于等于 
  lt 小于 
  elt 小于等于 
  heq 恒等于 
  nheq 不恒等于 
  2.范围标签
  in      
  <in name='n' value='9,10,11,12'>在这些数字里面<else/>不在这些数字的范围内</in>
  <notin name='n' value='9,10,11,12'>在这些数字里面<else/>不在这些数字的范围内</in>
  between
  <notbetween name='n' value='1,10'>{$n}在1-10之间<else/>{$n}不在1到10之间</between>
  3.present
  标签来判断模板变量是否已经赋值，
  <present name='m'>m有赋值<else/>m没有赋值</present>
  4.Empty
  empty标签判断模板变量是否为空，
  <empty name='n'>n为空赋值<else/>n有值</empty>
  5.Defined 
  判断常量是否已经定义
  6.Define
  在模板中定义常量
  7.Assing
  模板中变量赋值
 五、其他标签使用
  1、在模板中直接使用PHP代码
  <php> echo "我是赵桐正" </php>
  2、建议更改左右定界符
  在配置文件中改变
  'TMPL_L_DELIM'=>'<{', //修改左定界符
 
 'TMPL_R_DELIM'=>'}>', //修改右定界符

第十八课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 
第十八课代码

zhwdtcwd@gmail.com
 <?php
 class IndexAction extends Action{
   public function index(){
     //$this->assign('n',10);
     $this->assign('n',null);
     $this->display();
   }
 }
 ?>
 index.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
   </head>
   <body>
     <!--<if condition='$n eq 10'>
       10
       <else/>
       不是10
     </if>-->
     <eq name='n' value='10'>又一次输入10<else/>又一次输出不是10</eq>-->
     <in name='n' value='9,10,11,12'>在这些数字里面<else/>不在这些数字里面</in>
     <between name='n' value='1,10'>{$n}在1到10之间<else/>{$n}不在1到10之间</between>
     <present name='n'>n有赋值<else/>n没有赋值</present>
     <empty name='n'>n为空值<else/>n有值</empty>
     <php> echo '我是赵桐正'<php>
   </body>
 </html>
=========================================================================================
第十九课大纲

#
 # ThinkPHP 3.1.2 模板的使用技巧
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、模板包含
  <include file="完整模板文件名" />
  <include file="./Tpl/default/Public/header.html" />
  <include file="read" />
  <include file="Public:header" />
  <include file="blue:User:read" />
  <include file="$tplName" />
  <include file="header" title="ThinkPHP框架"keywords="开源WEB开发框架"/>
  在模板中变量用[变量]接受
  <include file='file1,file2' />
 二、模板渲染
  1、自动开启模板渲染 设置配置文件
  'LAYOUT_ON'=>true,//开启模板渲染
  准备一个模板渲染页面，在页面中使用{__CONTENT__}接受具体模板页面的内容
  如果在摸一个具体模板中不希望使用渲染模板，可以在页首添加{__NOCONTENT__}
  2、不开启自动模板渲染可以在每一个具体页面的页首添加
  <layout name='layout'/>
 三、模板的继承 
 
第十九课配置项
'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染

第十九课代码

index.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
     <load file="__PUBLIC__/Css/test.css"/>
   </head>
 <include file='Public:header'/>
 <include file='Public:header' css='test'/>
   <body>
     <p>这里是首页</p>
     <a href='__URL__/next'>跳转到下一页</a>
   </body>
 </html>
 IndexAction.class.php
 <?php
 class IndexAction extends Action{
   public funciton index(){
    $this->display();
   }
   public function next(){
    $this->display();
   }
 }
 ?>
 next.html
 <html>
   <head>
 <include file='Public:header'/>
 <include file='Public:header' css='test'/>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
     <load file="__PUBLIC__/Css/test.css"/>
   </head>
   <body>
     <p>这里是下一页</p>
     <a href='__URL__/index'>跳转到首页</a>
   </body>
 </html>
 header.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
     <load file="__PUBLIC__/Css/test.css"/> 
     <load file="__PUBLIC__/Css/[css].css"/>
   </head>
 index.html
     <layout name='layout'/>
     <p>这里是首页</p>
     <a href='__URL__/next'>跳转到下一页</a>
 next.html
     {__NOLAYOUT__}
     <layout name='layout'/>
     <p>这里是下一页</p>
     <a href='__URL__/index'>跳转到首页</a>
 tpl\layout.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
     <load file="__PUBLIC__/Css/test.css"/>
   </head>
   <body>
     <p>这里是渲染页面</p>
     {__CONTENT__}
   </body>
 </html>
 config.php
 <?php
 return array(
   'TMPL_L_DELIM'=>'<{', //修改左定界符
   'TMPL_R_DELIM'=>'}>', //修改右定界符
   'DB_PREFIX'=>'tp_',   //设置表前缀
   'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
   'SHOW_PAGE_TRACE'=>true, //开启页面Trace
   'LAYOUT_ON'=>true,
 );
 ?>
 
=========================================================================================
第二十课大纲

#
 # ThinkPHP 3.1.2 模板的使用技巧
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、模板包含
  <include file="完整模板文件名" />
  <include file="./Tpl/default/Public/header.html" />
  <include file="read" />
  <include file="Public:header" />
  <include file="blue:User:read" />
  <include file="$tplName" />
  <include file="header" title="ThinkPHP框架"keywords="开源WEB开发框架"/>
  在模板中变量用[变量]接受
  <include file='file1,file2' />
 二、模板渲染
  1、自动开启模板渲染 设置配置文件
  'LAYOUT_ON'=>true,//开启模板渲染
  准备一个模板渲染页面，在页面中使用{__CONTENT__}接受具体模板页面的内容
  如果在摸一个具体模板中不希望使用渲染模板，可以在页首添加{__NOCONTENT__}
  2、不开启自动模板渲染可以在每一个具体页面的页首添加
  <layout name='layout'/>
  3.使用技巧
  在渲染模板文件中也可以使用其他模板文件的内容
  <include file='Public:header'/>
  <body>
  <p>这里是渲染页面！！！</p>
  {__CONTENT__}
  </body>
  </html>
 三、模板的继承 
 
第二十课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染
 
第二十课代码 

Tpl\layout.html
 <extend name='Public:base'/>
 <block name='top'>
 <include file='Public:header'/>
 </block>
 <block name='body'>
 <body>
   <p>这里是渲染页面!!!</p>
   {__CONTENT__}
 </body>
 </block>
 Tpl\Public\base.html
 <block name='top'></block>
 <div style='border:1px solid gery;background:#abcdef;height:100px;'>广告部分</div>
 <block name='body'></block>
 Tpl\Public\header.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
     <load file="__PUBLIC__/Css/test.css"/>
   </head>
 Tpl\Index\index.html
     <p>这里是首页</p>
     <a href='__URL__/next'>跳转到下一页</a>
 Tpl\Index\next.html
     {__NOLAYOUT__}
     <p>这里是下一页</p>
     <a href='__URL__/index'>跳转到首页</a>
 
=========================================================================================
第二十一课大纲

#
 # ThinkPHP 3.1.2 控制器的模块和操作
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、空模块和空操作
  1、空操作
  function _empty($name){
  $this->show("$name 不存在 <a href='__APP__/Index/index'>返回首页</a>");
  }
  2.空模块
  class EmptyAction extends Action{
  function index(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $name=MODULE_NAME;
  $this->display("City:$name");
  }
  } 
 
二、前置操作和后置操作

config.php

<?php
 return array(
  //'配置项'=>'配置值'
  'DB_PREFIX'=>'',
  'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp3',
  'SHOW_PAGE_TRACE'=>true,
 );
 
?>

IndexAction.class.php

<?php
 // 本类由系统自动生成，仅供测试用途
 class IndexAction extends Action {
  public function index(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $this->display();
     }
 } 

index.html 

<include file='Public:header' />
  </body>
 </html>
 
CityAction.class.php 

<?php
  class CityAction extends Action{
  function bj(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $this->display();
  }
  function sh(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $this->display();
  }
  function gz(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $this->display();
  }
  function _empty($name){
  $this->show("$name 不存在 <a href='__APP__/Index/index'>返回首页</a>");
  }
  }
 ?>
 
bj.html 

<include file='Public:header' />
  <h1>欢迎你访问北京网页</h1>
  </body>
 </html>
 
sh.html 

<include file='Public:header' />
  <h1>欢迎你访问上海</h1>
  </body>
 </html>
 
gz.html 

<include file='Public:header' />
  <h1>欢迎你访问广州</h1>
  </body>
 </html>
 
header.html 

<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Index</title>
  <style>
  #daohang {
  height:100px;
  background:#abcdef;
  }
  a {
  border:1px solid gray;
  font-size:60px;
  text-decoration:none;
  }
  </style>
  </head>
  <body>
  <div id='daohang'>
  <foreach name='list' item='v'>
  <a href='__APP__/City/{$v.name}'>{$v.name}</a>
  </foreach>
  </div>
 
EmptyAction.class.php 

<?php
  class EmptyAction extends Action{
  function index(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $name=MODULE_NAME;
  $this->display("City:$name");
  }
  }
 ?> 

第二十一课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染

第二十一课代码

config.php
 <?php
 return array(
   //'配置项'=>'配置值'
   'DB_PREFIX'=>'',
   'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp3',
   'SHOW_PAGE_TRACE'=>true,
 );
 ?>
 IndexAction.class.php
 <?php
 class IndexAction extends Action{
   public function index(){
     $city=M('City');
     $arr=$city->select();
     $this->assign('list',$arr);
     $this->display();
   }
 }
 ?>
 index.html
 <include file='Public:header'/>
 <!--<html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
     <style>
     #daohang{
     height:150px;
     background:#abcdef;
     }
     #daohang a{
       border:1px solid gray;
       font-size"60px;
       text-decoration:none;
     }
     </style>
   </head>
 <body>
      <div id="daohang">
  <a href='__APP__/City/bj'>北京</a>
  <a href='__APP__/City/sh'>上海</a>
  <a href='__APP__/City/gz'>广州</a>
      </div>-->
 </body>
 </html>
 CityAction.class.php
 <?php
   class CityAction extends Action{
     function bj(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
       $this->display();
     }
     function sh(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
       $this->display();
     }
     function gz(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
       $this->display();
     }
     function _empty($name){
       $this->show("$name 不能存在 <a href='__APP__/Index/index'>返回首页");;
     }
   }
 ?>
 Tpl\City\bj.html
 <include file='Public:header'/>
 <!--<html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>bj</title>
   </head>-->
 <body>
    <h1>欢迎你来到北京！</h1>
 </body>
 </html>
 Tpl\City\sh.html
 <include file='Public:header'/>
 <!--<html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>sh</title>
   </head>-->
 <body>
    <h1>欢迎你来到上海！</h1>
 </body>
 </html>
 Tpl\City\gz.html
 <!--<html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>gz</title>
   </head>-->
 <body>
    <h1>欢迎你来到广州！</h1>
 </body>
 </html>
 Tpl\Public\header.html
 <html>
   <head>
     <meta http-equiv="content-type" content="text/html;charset=utf-8">
     <title>Index</title>
     <style>
     #daohang{
     height:150px;
     background:#abcdef;
     }
     #daohang a{
       border:1px solid gray;
       font-size"60px;
       text-decoration:none;
     }
     </style>
   </head>
 <body>
      <div id="daohang">
  <foreach name='list' item='v'>
   <a href='__APP__/City/{$v.name}'>{$v.name}</a>
  </foreach>
  <!--<a href='__URL__/City/bj'>北京</a>
  <a href='__URL__/City/sh'>上海</a>
  <a href='__URL__/City/gz'>广州</a>-->
      </div>
 EmptyAction.class.php
 <?php
   class EmptyAction extends Action{
     function index(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
        //$this->show('该方法不存在！');
        $name=MODULE_NAME;
        $this->display("City:$name"); //City模块下的名字
     }
   }
 ?>
 
=========================================================================================
第二十二课大纲

#
 # ThinkPHP 3.1.2 控制器的模块和操作
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、空模块和空操作
  1、空操作
  function _empty($name){
  $this->show("$name 不存在 <a href='__APP__/Index/index'>返回首页</a>");
  }
  2.空模块
  class EmptyAction extends Action{
  function index(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $name=MODULE_NAME;
  $this->display("City:$name");
  }
  }
 二、前置操作和后置操作
  1、前置操作： _before_操作名
 
 2、后置操作： _after_操作名

config.php
 <?php
 return array(
 //'配置项'=>'配置值'
  'DB_PREFIX'=>'',
  'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp3',
 'SHOW_PAGE_TRACE'=>true,
 );
 ?>
 IndexAction.class.php
 <?php
 // 本类由系统自动生成，仅供测试用途
 class IndexAction extends Action {
  public function _before_index(){
  //做判断，如果没有登录，跳转到登陆页面
  if(!isset($_SESSION['username']) || $_SESSION['username']==''){
  $this->redirect('Login/index');
  }
  }
  public function index(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $this->display();
  }
  public function _after_index(){
  echo '<script>alert("欢迎你访问本网站")</script>';
  }
 }
 CityAction.class.php
 <?php
  class CityAction extends Action{
  function bj(){
  $oi=new IndexAction();
  $oi->index();
  }
  function sh(){
  $oi=new IndexAction();
  $oi->index();
  }
  function gz(){
  $oi=new IndexAction();
  $oi->index();
  }
  function _empty($name){
  $this->show("$name 不存在 <a href='__APP__/Index/index'>返回首页
 

</a>");
  }
  }
 ?>
 EmptyAction.class.php
 <?php
  class EmptyAction extends Action{
  function index(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $name=MODULE_NAME;
  $this->display("City:$name");
  }
  }
 ?>
 LoginAction.class.php
 <?php
  class LoginAction extends Action{
  public function index(){
  $this->display();
  }
  public function do_login(){
  $username=$_POST['username'];
  $password=$_POST['password'];
  $user=M('User');
  $where['username']=$username;
  $where['password']=$password;
  $c=$user->where($where)->count();
  if($c>0){
  $_SESSION['username']=$username;
  $this->redirect('Index/index');
  }else{
  $this->error('用户不能登录');
  }
  }
  }
 ?>
 Public\header.html
 <html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Index</title>
  <style>
  #daohang {
  height:100px;
  background:#abcdef;
  }
  a {
  border:1px solid gray;
  font-size:60px;
  text-decoration:none;
  }
  </style>
  </head>
  <body>
  <div id='daohang'>
  <foreach name='list' item='v'>
  <a href='__APP__/City/{$v.name}'>{$v.name}</a>
  </foreach>
  </div>
 Index\index.html
 <include file='Public:header' />
  </body>
 </html>
 City\bj.html
 <include file='Public:header' />
  <h1>欢迎你访问北京网页</h1>
  </body>
 </html>
 City\gz.html
 <include file='Public:header' />
  <h1>欢迎你访问广州</h1>
  </body>
 </html>
 City\sh.html
 <include file='Public:header' />
  <h1>欢迎你访问上海</h1>
  </body>
 </html>
 
第二十二课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染

第二十二课代码

Login\index.html
 <html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Index</title>
  </head>
  <body>
  <form action="__URL__/do_login" method='post'>
  用户名:<input type='text' name='username'/><br/>
  密　码:<input type='password' name='password'/><br/>
  <input type='submit' value='登录'/>
  </form>
  </body>
 </html>
 CityAction.class.php
 <?php
 // 本类由系统自动生成，仅供测试用途
 class CityAction extends Action {
     public function bj(){
   $oi=new IndexAction();
   $oi->index();
     }
     public function sh(){
   $oi=new IndexAction();
   $oi->index();
     }
     public function gz(){
   $oi=new IndexAction();
   $oi->index();
     } 
     function _empty($name){
       $this->show("$name 不能存在 <a href='__APP__/Index/index'>返回首页</a>");
     }
 }
 IndexAction.class.php
 <?php
 // 本类由系统自动生成，仅供测试用途
 class IndexAction extends Action {
  public function _before_index(){
  if(!isset($_SESSION['username']) || $_SESSION['username']==''){
     $this->redirect('Login/index');
  } 
  }
     public function index(){
  $city=M('City');
  $arr=$city->select();
  $this->assign('list',$arr);
  $this->display();
     }
  public function _after_index(){
   $this->show("<script>alert('欢迎你访问本网站')</script>");
  }
 }
 LoginAction.class.php
 <?php
  class LoginAction extends Action{
  public function do_login(){
   $username=$_POST['username'];
   $password=$_POST['password'];
   $user=M('user');
   $where['username']=$username;
   $where['password']=$password;
   $c=$user->where($where)->count();
   if($c>0){
     $_SESSION['username']=$username;
  $this->redirect('Index/index');
   }else{
     $this->error('用户不能登录');
   }
  }
  public function index(){
   $this->display();
  }
  }
 ?>
 
=========================================================================================
第二十三课大纲

#
 # ThinkPHP 3.1.2 URL
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、URL规则
  1、默认是区分大小写的 
  2、如果我们不想区分大小写可以改配置文件
  'URL_CASE_INSENSITIVE'=>true,//url不区分大小写 
  3、如果模块名为 UserGroupAction
  那么url找模块就必要要写成
  http://localhost/thinkphp4/index.php/user_group/index
  4、如果'URL_CASE_INSENSITIVE'=>false
  那么url也可以写为
  http://localhost/thinkphp4/index.php/UserGroup/index
 二、URL伪静态
  'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
 三、URL路由
  1、启动路由
  要在配置文件中开启路由支持
  2、使用路由
  1.规则表达式配置路由
  'my'=>'Index/index',//静态地址路由
  ':id/:num'=>'Index/index',//动态地址路由
  'year/:year/:month/:date'=>'Index/index',//动态和静态混合地址路由
  'year/:year\d/:month\d/:date\d'=>'Index/index',//动态和静态混合地址路由 
  加上 \d代表类型只能是数字
  'my/:id$'=>'Index/index',// 加上$说明地址中只能是 my/1000 后面不能有其他内容了
  2.正则表达式配置路由
 四、URL重写
 五、URL生成
 
第二十三课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染
 'URL_CASE_INSENSITIVE'=>true,//url不区分大小写
 'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀

第二十三课代码 

IndexAction.class.php
 http://localhost/thinkphp4/index.php/index/index
 <?php
   class IndexAction extends Action{
     public function index(){
       $this->show('Hello World!!!');
       echo '<hr>';
       //echo ' id is:'.$_GET['id'];
       //echo ' num is:'.$_GET['num'];
       //echo "{$_GET['year']}年{$_GET['month']}月{$_GET['day']}日";
       echo $_GET['id'];
     }
   }
 ?>
 config.php
 <?php
 return array(
   'URL_CASE_INSENSITIVE'=>true,//url不区分大小写
   'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
   'URL_ROUTER_ON'=>true, //开启路由项
   'URL_ROUTE_RULES'=>array(
      //'my'=>'Index/index',//静态地址路由
      //':id/:num'=>'Index/index', //动态地址路由
      //'my/:num'=>'Index/index', //动态和静态混合地址路由
      //'year/:year\d/:month\d/:day\d'=>'Index/index',
      'my/:id$'=>'Index/index',//$代表url最后的部分了
   ),
 );
 ?>
 UserGroupAction.class.php
 http://localhost/thinkphp4/index.php/user_group/index
 <?php
 class UserGroupAction extends Action{
 public function index(){
   $this->show('执行到这里！');
 }
 }
 ?> 
=========================================================================================
第二十四课大纲

#
 # ThinkPHP 3.1.2 URL
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、URL规则
  1、默认是区分大小写的
  2、如果我们不想区分大小写可以改配置文件
  'URL_CASE_INSENSITIVE'=>true,//url不区分大小写 
  3、如果模块名为 UserGroupAction
  那么url找模块就必要要写成
  http://localhost/thinkphp4/index.php/user_group/index
  4、如果'URL_CASE_INSENSITIVE'=>false
  那么url也可以写为
  http://localhost/thinkphp4/index.php/UserGroup/index
 二、URL伪静态
  'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
 三、URL路由
  1、启动路由
  要在配置文件中开启路由支持
  2、使用路由
  1.规则表达式配置路由
  'my'=>'Index/index',//静态地址路由
  ':id/:num'=>'Index/index',//动态地址路由
  'year/:year/:month/:date'=>'Index/index',//动态和静态混合地址路由
  'year/:year\d/:month\d/:date\d'=>'Index/index',//动态和静态混合地址路由 
  加上 \d代表类型只能是数字
  'my/:id$'=>'Index/index',// 加上$说明地址中只能是 my/1000 后面不能有其他内容了
  2.正则表达式配置路由
  '/^year\/(\d{4})\/(\d{2})\/(\d{2})/'=>'Index/index?year=:1&month=:2&date=:3'
  3、注意事项：
  1.越复杂的路由越往前面放
  'URL_ROUTE_RULES'=>array(
  'my/:year/:month:/:day'=>'Index/day',
  'my/:id\d'=>'Index/index',
  'my/:name'=>'Index/index',
  )
  2.可以使用$作为完全匹配的路由规则
  'URL_ROUTE_RULES'=>array(
  'my/:id\d$'=>'Index/index',
  'my/:name$'=>'Index/index',
  'my/:year/:month:/:day$'=>'Index/day',
  ),
  3.用正则匹配的方式
  'URL_ROUTE_RULES'=>array(
  '/^my\/(\d+)$/'=>'Index/index?id=:1',
  '/^my\/(\w+)$/'=>'Index/index?name=:1',
  '/^my\/(\d{4})\/(\d{2})\/(\d{2})$/'=>'Index/day?year=:1&month=:2&day=:3',
  ),
  
四、URL重写
 
五、URL生成

第二十四课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染
 'URL_CASE_INSENSITIVE'=>true,//url不区分大小写
 'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀

第二十四课代码

config.php
 <?php
 return array(
   'URL_CASE_INSENSITIVE'=>false,//url不区分大小写
   'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
   'URL_ROUTER_ON'=>true,
   'URL_ROUTE_RULES'=>array(
     //'year/:year\d/:month/:date'=>'Index/index',
     //'/^year\/(\d{4})\/(\d{2})\/(\d{2})/'=>'Index/index?year=:1&month=:2&date=:3',
     'my/:id\d'=>'Index/index',
     'my/:name'=>'Index/index',
     'my/:year/:month/:day'=>'Index/day',
   )
 ),
 ?>
 IndexAction.class.php
 <?php
 class IndexAction extends Action{
   public function index(){
     echo 'id:'.$_GET['id'];
     echo "<hr>";
     echo 'name:'.$_GET['name'];
   }
   public function day(){
     echo "今年是{$_GET['year']}年{$_GET['month']}月{$_GET['day']}日";
   }
   public function url(){
     //echo U('Index/index');
     echo U('Index/index',array('id'=>1,'name'=>'ztz'),'shtml');
   }
 }
 ?>
=========================================================================================
第二十五课大纲

#
 # ThinkPHP 3.1.2 URL
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、多应用配置技巧
 二、使用分组
 三、页面跳转
  $this->success('查询成功',U('User/test'));
  $this->redirect('User/test','',5,'页面正在跳');
 四、Ajax技巧
 
第二十五课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染
 'URL_CASE_INSENSITIVE'=>true,//url不区分大小写
 'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
 'APP_GROUP_LIST' => 'Home,Admin', //项目分组设定
 'DEFAULT_GROUP'  => 'Home', //默认分组
 
第二十五课代码

<!--thinkphp5-->
 config.php 主入口文件下的目录\config.php(公共的配置文件)
 <?php
 return array(
    //'配置项'=>'配置值'
    'DB_PREFIX'=>'tp_',
    'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',
 );
 ?>
 Home\conf\config.php
 config.php
 <?php
 $arr=include './config.php';  //主入口文件的当前目录
 $arr2=array(
 );
 return array_merge($arr,$arr2); //合并两个数组
 ?>
 Admin\conf\config.php
 config.php
 <?php
 $arr=include './config.php';
 $arr2=array(
 );
 return array_merge($arr,$arr2);
 ?>
 IndexAction.class.php
 <?php
 // 本类由系统自动生成，仅供测试用途
 class IndexAction extends Action {
     public function index(){
  $user=M('User');
  $arr=$user->select();
  //dump($arr);
  $this->assign('list',$arr);
  $this->display();
     }
     public function info(){
       $id=$_GET['id'];
       $user=M('User');      
       $arr=$user->find($id);
       //dump($arr);
       if($arr){
  //$this->success();
  //$this->success('查询成功','index');
         //$this->success('查询成功',U('User/test'));
         //$this->redirect('User/test');
         $this->redirect('User/test','',5,'页面正在跳转中...');
       }else{
         $this->error('查询失败');
       }
       //$this->assign('list',$arr);
       //$this->display();
     }
 }
 UserAction.class.php
 <?php
 class UserAction extends Action{
   function test(){
     $this->show('<h1>User模块下的test方法</h1>');
   }
 }
 ?>
 index.html
 <html>
 <head>
 <meta http-equiv="content-type" content="text/html;charset=UTF-8">
 <title>Index</title>
 </head>
 <body>
 <table border='1' width='500'>
 <foreach name='list' item='vo'>
 <tr><td><a href="__URL__/info?id={$vo.id}">{$vo.username}</a></td></tr>
 </foreach>
 </table>
 </body>
 </html>
 info.html
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html" charset="UTF-8">
 <title>Index</title>
 </head>
 <body>
 姓名：{$list.username}
 性别：{$list.sex}
 </body>
 </html>
 Ajax
 IndexAction.class.php
 <?php
 class IndexAction extends Action{
   public function index(){
     $this->display();
   }
   public function getAjax(){
     $this->ajaxreturn('这里是我要的数据','信息1',1);
   }
 }
 ?>
 index.html
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html" charset="UTF-8">
 <title>Index</title>
 <script src="__PUBLIC__/Js/jquery.js"></script>
 <script>
 $(function(){
 $('button').bind('click',function(){
   $.get('__URL__/getAjax',function(data){
     //alert(JSON.stringify(data));
     if(data.status=1){
      //alert(data.data);
      $('div#did').html(data.data);
     }
   });
 });
 });
 </script>
 </head>
 <body>
 <div style="height:50px;background:yellow" id="did"></div>
 <button>点击</button>
 <script>
 document.write(new Date());
 </script>
 </div>
 </body>
 </html>
 <!--thinkphp6-->
 index.php
 <?php
 //1.确定应用名称 APP
 define('APP_NAME','App');
 //2.确定应用路径
 define('APP_PATH','./APP/');
 //3.开启调试模式
 define('APP_DEBUG',true);
 //4.应用核心文件
 require './ThinkPHP/ThinkPHP.php';
 ?>
 config.php
 <?php
 return array(
 //'配置项'=>'配置值'
 'APP_GROUT_LIST'=>'Home,Admin',//项目分组设定
 'DEFAULT_GROUP'=>'Home',//默认分组
 );
 ?>
 http://localhost/thinkphp6/index.php/Home/Index/index
 http://localhost/thinkphp6/index.php/Admin/Index/index
 \Lib\Home\IndexAction.class.php
 \Lib\Admin\IndexAction.class.php
 
=========================================================================================
第二十六课大纲

#
 # ThinkPHP 3.1.2 需求分析和原型设计
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、原型设计
 二、数据库设计
 三、目录结构搭建
 
第二十六课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染
 'URL_CASE_INSENSITIVE'=>true,//url不区分大小写
 'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
 'APP_GROUP_LIST' => 'Home,Admin', //项目分组设定
 'DEFAULT_GROUP'  => 'Home', //默认分组

=========================================================================================
第二十七课大纲

#
 # ThinkPHP 3.1.2 需求分析和原型设计
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、原型设计
 二、数据库设计
 三、目录结构搭建
 
第二十七课配置项 

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染
 'URL_CASE_INSENSITIVE'=>true,//url不区分大小写
 'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
 'APP_GROUP_LIST' => 'Home,Admin', //项目分组设定
 'DEFAULT_GROUP'  => 'Home', //默认分组

第二十七课代码

IndexAction.class.php
 <?php
 class IndexAction extends Action{
   public function index(){
     //判断用户是否登陆过 通过session
     if(isset($_SESSION['username']) && $_SESSION['username']!=''){
       $this->display();
     }else{
       $this->redirect('Login/login');
     }
   }
   public function top(){
     $this->display();
   }
   public function left(){
     $this->display();
   }
   public function right(){
     $this->display();
   }
 }
 ?>
 LoginAction.class.php
 <?php
 class LoginAction extends Action{
   public function login(){
     $this->display();
   }
   public function doLogin(){
     //接收值
     //判断用户在数据库中是否存在
     //存在 允许登陆
     //不存在 显示错误信息
     $username=$_POST['username'];
     $password=$_POST['password'];
     $code=$_POST['code'];
     if(md5($code)!=$_SESSION['code']){
         $this->error('验证码不正确');
     }
     $user=M('User');
     $where['username']=$username;
     $where['passwrd']=$password;
     //$count=$user->where($where)->count();
     //if($count>0){
       //$_SESSION['username']=$username;
       //$this->success('用户登陆成功',U('Index/index'));
     //}else{
       //$this->error('该用户不存在');
     //}
     $arr=$user->field('id')->where($where)->find();
     if($arr){
         $_SESSION['username']=$username;
         $_SESSION['id']=$arr['id'];
         $this->success('用户登陆成功',U('Index/index'));
     }else{
         $this->error('该用户不存在');
     }
   }
 }
 ?>
 MessageAction.class.php
 PublicAction.class.php(tp_message\ThinkPHP\Extend\Library\ORG\Util\Image.class.php)
 <?php
   class PublicAction extends Action{
     public function code(){
       import('ORG.Util.Image');
       image::buildImageVerify(2,1,'png',30,30,'code');
     }
   }
 ?>
 RegisterAction.class.php
 index.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
 

"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Index</title>
 </head>
 <body>
 <frameset rows='20%,*'>
    <frame src='__URL__/top' name='top'/>
    <frameset cols='50%,50%'>
       <frame src='__URL__/left' name='left'>
       <frame src='__URL__/right' name='right'>
    </frameset>
 </frameset>
 </body>
 </html>
 top.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
 

"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>top</title>
 </head>
 <body>
 top
 </body>
 </html>
 left.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
 

"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>left</title>
 </head>
 <body>
 left
 </body>
 </html>
 right.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
 

"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>right</title>
 </head>
 <body>
 right
 </body>
 </html>
 login.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
 

"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Index</title>
 <load href="__PUBLIC__/Css/basic.css"/>
 <load href="__PUBLIC__/Css/Home/login.css"/>
 <load href="__PUBLIC__/Js/jquery.js"/>
 <style>
 *{
 padding:0;
 margin:0;
 }
 form{
 width:300px;
 margin:0 auto;
 }
 form input{
 width:120px;
 height:30px;
 margin-top:30px;
 }
 form img{
 position:relative;
 top:10px;
 }
 </style>
 <script>
 $(function(){
   $('img[title="login"]').click(function(){
     $('form[name="myForm"]').submit();
   });
 });
 </script>
 </head>
 <body>
   <form action='__URL__/doLogin' method='post' name='myForm'>
     用户名：<input type='text' name='username'/><br/>
     密　码：<input type='password' name='password'/><br/>
     验证码：<input type='text' name='code'/><img src='__APP__/Public/code'onclick="this.src=this.src+'?'+Math.random()"><br/>
     <img src='__PUBLIC__/Images/login.gif' title='login'/>
     <img src='__PUBLIC__/Images/register.gif'/>
   </form>
 </body>
 Login
 </body>
 </html>
 
=========================================================================================
第二十八课大纲

#
 # ThinkPHP 3.1.2 需求分析和原型设计
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课大纲：
 一、原型设计
 二、数据库设计
 
三、目录结构搭建

第二十八课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染
 'URL_CASE_INSENSITIVE'=>true,//url不区分大小写
 'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
 'APP_GROUP_LIST' => 'Home,Admin', //项目分组设定
 'DEFAULT_GROUP'  => 'Home', //默认分组
 
第二十八课说明

请完善注册页面的表单判断

第二十八课代码 

IndexAction.class.php
 <?php
 class IndexAction extends Action{
   public function index(){
     //判断用户是否登陆过 通过session
     if(isset($_SESSION['username']) && $_SESSION['username']!=''){
       $this->display();
     }else{
       $this->redirect('Login/login');
     }
   }
   public function top(){
     //$this->assign('name',$_SESSION['username']);
     $this->display();
   }
   public function left(){
     $this->display();
   }
   public function right(){
     $this->display();
   }
 }
 ?>
 >>>>>>>>>>>>>>
 index.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-
 

transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Index</title>
 </head>
 <body>
 <frameset rows='20%,*'>
    <frame src='__URL__/top' name='top'/>
    <frameset cols='50%,50%'>
       <frame src='__URL__/left' name='left'>
       <frame src='__URL__/right' name='right'>
    </frameset>
 </frameset>
 </body>
 </html>
 >>>>>>>>>>>>>>
 top.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-
 

transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>top</title>
 </head>
 <body>
 <h1>ThinkPHP留言板系统</h1>
 <!--<p 欢迎你{$name}><a href='__APP__/Login/doLogout' target='_top'>退出</a></p>-->
 <p 欢迎你{$Think.session.username}><a>退出</a></p>
 </body>
 </html>
 >>>>>>>>>>>>>>
 left.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-
 

transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>left</title>
 </head>
 <body>
 left
 </body>
 </html>
 >>>>>>>>>>>>>>
 right.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-
 

transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>right</title>
 </head>
 <body>
 right
 </body>
 </html>
 >>>>>>>>>>>>>>
 LoginAction.class.php
 <?php
 class LoginAction extends Action{
   public function login(){
     $this->display();
   }
   public function doLogin(){
     //接收值
     //判断用户在数据库中是否存在
     //存在 允许登陆
     //不存在 显示错误信息
     $username=$_POST['username'];
     $password=$_POST['password'];
     $code=$_POST['code'];
     if(md5($code)!=$_SESSION['code']){
         $this->error('验证码不正确');
     }
     $user=M('User');
     $where['username']=$username;
     $where['passwrd']=$password;
     //$count=$user->where($where)->count();
     //if($count>0){
       //$_SESSION['username']=$username;
       //$this->success('用户登陆成功',U('Index/index'));
     //}else{
       //$this->error('该用户不存在');
     //}
     $arr=$user->field('id')->where($where)->find();
     if($arr){
         $_SESSION['username']=$username;
         $_SESSION['id']=$arr['id'];
         $this->success('用户登陆成功',U('Index/index'));
     }else{
         $this->error('该用户不存在');
     }
     //退出
     public function doLogout(){
       $_SESSION=array();    
       if(isset($_COOKIE[session_name()])){
         setcookie(session_name(),'',time()-1,'/'); //time()-1让时间过期
       }
       session_destroy(); //它可以把服务器端的SESSION文件删掉
       $this->redirect('Index/index');
     }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 login.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-
 

transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Index</title>
 <load href="__PUBLIC__/Css/basic.css"/>
 <load href="__PUBLIC__/Css/Home/login.css"/>
 <load href="__PUBLIC__/Js/jquery.js"/>
 <style>
 *{
 padding:0;
 margin:0;
 }
 form{
 width:300px;
 margin:0 auto;
 }
 form input{
 width:120px;
 height:30px;
 margin-top:30px;
 }
 form img{
 position:relative;
 top:10px;
 }
 </style>
 <script>
 $(function(){
   $('img[title="login"]').click(function(){
     $('form[name="myForm"]').submit();
   });
   $('img[class="register"]').click(function(){
     window.location='__APP__/Register/reg';
   });
 });
 </script>
 </head>
 <body>
   <form action='__URL__/doLogin' method='post' name='myForm'>
     用户名：<input type='text' name='username'/><br/>
     密　码：<input type='password' name='password'/><br/>
     验证码：<input type='text' name='code'/><img src='__APP__/Public/code?w=30&h=30'onclick="this.src=this.src
 

+'?'+Math.random()"><br/>
     <img src='__PUBLIC__/Images/login.gif' title='login'/>
     <img src='__PUBLIC__/Images/register.gif' class='register'/>
   </form>
 </body>
 >>>>>>>>>>>>>>
 MessageAction.class.php
 PublicAction.class.php(tp_message\ThinkPHP\Extend\Library\ORG\Util\Image.class.php)
 <?php
   class PublicAction extends Action{
     public function code(){
       $w=isset($_GET['w'])?$_GET['w']:30;
       $h=isset($_GET['h'])?$_GET['h']:30;
       import('ORG.Util.Image');
       image::buildImageVerify(2,1,'png',$w,$h,'code');
     }
   }
 ?>
 >>>>>>>>>>>>>>
 RegisterAction.class.php
 <?php
 class RegisterAction extends Action{
   public function reg(){
     $this->display();
   }
   //检查用户是否注册过
   public function checkName(){
     $username=$_GET['username'];
  $user=M('user');
  $where['username']=$username;
  $count=$user->where($where)->count();
  if($count>0){
   echo '不允许';
  }else{
   echo '允许';
  }
   }
   //注册
   public function doReg(){
     $username=$_POST['username'];
     $password=$_POST['password'];
     $repassword=$_POST['repassword'];
     $sex=$_POST['sex'];
     $user=M('user');
     $data['username']=$username;
     $data['password']=$password;
     $data['sex']=$sex;
     $lastId=$user->add($data);
     if($lastId){
       $this->redirect('Index/index');
     }else{
       $this->error('用户注册失败');
     }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 reg.html
 <taglib name='Message' />
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Register</title>
 <load href="__PUBLIC__/Css/basic.css"/>
 <load href="__PUBLIC__/Css/Home/reg.css"/>
 <load href="__PUBLIC__/Js/jquery.js"/>
 <style>
 *{
 padding:0;
 margin:0;
 }
 form{
 width:300px;
 margin:0 auto;
 }
 form input{
 width:120px;
 height:30px;
 margin-top:30px;
 }
 form img{
 position:relative;
 top:10px;
 }
 form input.radio{
 width:30px;
 height:10px;
 }
 </style>
 <script>
 $(function(){
   var error = new Array(); //Array大写
   $('input[name="username"]').blur(function(){
       var username=$(this).val();
       $.get('__URL__/checkName',{'username':username},function(data){
     if(data=='不允许'){
   error['username']=1;
   $('input[name="username"]').after('<p id="message" style="color:red">该用户名已注册</p>');
  }else{
   error['username']=0;
   $('#message').remove();
  }
   }); 
   });
   $('img.register').click(function(){
     if(error['username']==1){
   return false;
  }else{
   $('form[name="myForm"]').submit();
  }
   });
 });
 </script>
 </head>
 <body>
   <form action='__URL__/doReg' method='post' name='myForm'>
     用 户 名：<input type='text' name='username'/><br/>
     密　　码：<input type='password' name='password'/><br/>
     确认密码：<input type='password' name='repassword'/><br/>
     性　　 别：<input type='radio' class='radio' name='sex' value='1'/>男
    <input type='radio' class='radio' name='sex' value='0'/>女
     验证码：<input type='text' name='code'/>
             <Message:code width='30' height='30'/> //更简单的使用验证码方式
 <img src='__APP__/Public/code?w=30&h=30'onclick="this.src=this.src+'?'+Math.random()"><br/>
     <img src='__PUBLIC__/Images/register.gif' class='register'/>
     <img src='__PUBLIC__/Images/reset.gif' class='reset'/>
   </form>
 </body>
 >>>>>>>>>>>>>>
 config.php
 <?php
 return array(
 'DB_PREFIX'=>'tp_',
 'DB_DSN'='mysql://root:@localhost:3306/message',
 'TMPL_L_DELIM'=>'<{',
 'TMPL_R_DELIM'=>'}>',
 );
 ?>
 >>>>>>>>>>>>>>
 www\tp_message\ThinkPHP\Lib\Driver\TagLib
 实例化一个不存在的类！:TagLibHtml 检查文件名是否创建正确，注意分清大小写
 TagLibMessage.class.php
 <?php
 class TagLibMessage extends TagLib{
   protected $tags = array(
     'code'=>array('attr'=>'width,height','close'=>0),
   );
   public function _code($attr){
     $tag = $this->parseXmlAttr($attr,'code');
  $width = $tag['width'];
  $height = $tag['height'];
  $str = "<img src='__APP__/Public/code?w={$width}&h={$height}' onclick='this.src=this.src+\"?\"+Math.random
 

()'/>";
  return $str;
   }
 }
 ?>

=========================================================================================
第二十九课大纲

#
 # ThinkPHP 3.1.2 权限判断和三大自动
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课知识点：
 1.权限控制
 2.自动创建
 3.自动验证
 4.文件上传
 
第二十九课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染
 'URL_CASE_INSENSITIVE'=>true,//url不区分大小写
 'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
 'APP_GROUP_LIST' => 'Home,Admin', //项目分组设定
 'DEFAULT_GROUP'  => 'Home', //默认分组

第二十九课代码 

IndexAction.class.php
 <?php
 // 本类由系统自动生成，仅供测试用途
 class IndexAction extends CommonAction {
     public function index(){
   //dump(M('user')->select());
  $this->display();
     }
  public function top(){
   $this->assign('name',$_SESSION['username']);
   $this->display();
  }
  public function left(){
   $this->display();
  }
  public function right(){
   $this->display();
  } 
 }
 ?>
 >>>>>>>>>>>>>>
 index.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Index</title>
 </head>
 <body>
 <frameset rows='20%,*'>
    <frame src='__URL__/top' name='top'/>
    <frameset cols='50%,50%'>
       <frame src='__URL__/left' name='left'>
       <frame src='__URL__/right' name='right'>
    </frameset>
 </frameset>
 </body>
 </html>
 >>>>>>>>>>>>>>
 top.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>top</title>
 </head>
 <body>
 <h1>ThinkPHP留言板系统</h1>
 <!--<p 欢迎你{$name}><a href='__APP__/Login/doLogout' target='_top'>退出</a></p>-->
 <p 欢迎你{$Think.session.username}><a>退出</a></p>
 </body>
 </html>
 >>>>>>>>>>>>>>
 left.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>left</title>
 </head>
 <body>
 left
 </body>
 </html>
 >>>>>>>>>>>>>>
 right.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>right</title>
 </head>
 <body action='__APP__/Message/doMess' method='post' enctype='multipart/form-data'>
 留言题目:<input type='text' name='title'/><br/>
 留言内容:<textarea name='content'></textarea><br>
 选择附件:<input type='file' name='filename'/><br/>
 <input type='submit'/>
 </body>
 </html>
 >>>>>>>>>>>>>>
 LoginAction.class.php
 <?php
 class LoginAction extends Action{
   public function login(){
     $this->display();
   }
   public function doLogin(){
     //接收值
     //判断用户在数据库中是否存在
     //存在 允许登陆
     //不存在 显示错误信息
     $username=$_POST['username'];
     $password=$_POST['password'];
     $code=$_POST['code'];
     if(md5($code)!=$_SESSION['code']){
         $this->error('验证码不正确');
     }
     $user=M('User');
     $where['username']=$username;
     $where['passwrd']=$password;
     //$count=$user->where($where)->count();
     //if($count>0){
       //$_SESSION['username']=$username;
       //$this->success('用户登陆成功',U('Index/index'));
     //}else{
       //$this->error('该用户不存在');
     //}
     $arr=$user->field('id')->where($where)->find();
     if($arr){
         $_SESSION['username']=$username;
         $_SESSION['id']=$arr['id'];
         $this->success('用户登陆成功',U('Index/index'));
     }else{
         $this->error('该用户不存在');
     }
     //退出
     public function doLogout(){
       $_SESSION=array();    
       if(isset($_COOKIE[session_name()])){
         setcookie(session_name(),'',time()-1,'/'); //time()-1让时间过期
       }
       session_destroy(); //它可以把服务器端的SESSION文件删掉
       $this->redirect('Index/index');
     }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 login.html
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Index</title>
 <load href="__PUBLIC__/Css/basic.css"/>
 <load href="__PUBLIC__/Css/Home/login.css"/>
 <load href="__PUBLIC__/Js/jquery.js"/>
 <style>
 *{
 padding:0;
 margin:0;
 }
 form{
 width:300px;
 margin:0 auto;
 }
 form input{
 width:120px;
 height:30px;
 margin-top:30px;
 }
 form img{
 position:relative;
 top:10px;
 }
 </style>
 <script>
 $(function(){
   $('img[title="login"]').click(function(){
     $('form[name="myForm"]').submit();
   });
   $('img[class="register"]').click(function(){
     window.location='__APP__/Register/reg';
   });
 });
 </script>
 </head>
 <body>
   <form action='__URL__/doLogin' method='post' name='myForm'>
     用户名：<input type='text' name='username'/><br/>
     密　码：<input type='password' name='password'/><br/>
     验证码：<input type='text' name='code'/><img src='__APP__/Public/code?w=30&h=30'onclick="this.src=this.src+'?'+Math.random()"><br/>
     <img src='__PUBLIC__/Images/login.gif' title='login'/>
     <img src='__PUBLIC__/Images/register.gif' class='register'/>
   </form>
 </body>
 >>>>>>>>>>>>>>
 MessageAction.class.php
 <?php
 class MessageAction extends Action{
   public function doMess(){
     $message=M('Message');
     $message->create();
     import('ORG.Net.UploadFile');
     $upload = new UploadFile();//实例化上传类
     $upload->savePath = './Public/Uploads/';//设置附件上传目录
     if(!$upload->upload()){//上传错误提示错误信息
       $this->error($upload->getErrorMsG());
     }else{//上传成功 获取上传信息
       $info = $upload->getUploadFileInfo();
     }    
     $message->filename=$info[0]['savename'];
     $message->time=time();
     $message->uid=$_SESSION['id'];
     $lastId=$message->add();
     if($lastId){
       $this->success('数据写入成功');
     }else{
       $this->error(留言失败);
     }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 PublicAction.class.php(tp_message\ThinkPHP\Extend\Library\ORG\Util\Image.class.php)
 <?php
   class PublicAction extends Action{
     public function code(){
       $w=isset($_GET['w'])?$_GET['w']:30;
       $h=isset($_GET['h'])?$_GET['h']:30;
       import('ORG.Util.Image');
       image::buildImageVerify(2,1,'png',$w,$h,'code');
     }
   }
 ?>
 >>>>>>>>>>>>>>
 RegisterAction.class.php
 <?php
 class RegisterAction extends Action{
   public function reg(){
     $this->display();
   }
   //检查用户是否注册过
   public function checkName(){
     $username=$_GET['username'];
  $user=M('user');
  $where['username']=$username;
  $count=$user->where($where)->count();
  if($count>0){
   echo '不允许';
  }else{
   echo '允许';
  }
   }
   //注册
   public function doReg(){
     $user=D('User');  //User要和UserModel一样
     if(!$user->create()){
       $this->error($user->getError());
     }
     //$user->ceate(); 自动创建 三大自动里面第一自动
     $lastId=$user->add();
     if($lastId){
       $this->redirect('Index/index');
     }else{
       $this->error('用户注册失败');
     }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 reg.html  注册模板文件
 <taglib name='Message' />
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Register</title>
 <load href="__PUBLIC__/Css/basic.css"/>
 <load href="__PUBLIC__/Css/Home/reg.css"/>
 <load href="__PUBLIC__/Js/jquery.js"/>
 <style>
 *{
 padding:0;
 margin:0;
 }
 form{
 width:300px;
 margin:0 auto;
 }
 form input{
 width:120px;
 height:30px;
 margin-top:30px;
 }
 form img{
 position:relative;
 top:10px;
 }
 form input.radio{
 width:30px;
 height:10px;
 }
 </style>
 <script>
 $(function(){
   var error = new Array(); //Array大写
   $('input[name="username"]').blur(function(){
       var username=$(this).val();
       $.get('__URL__/checkName',{'username':username},function(data){
     if(data=='不允许'){
   error['username']=1;
   $('input[name="username"]').after('<p id="message" style="color:red">该用户名已注册</p>');
  }else{
   error['username']=0;
   $('#message').remove();
  }
   }); 
   });
   $('img.register').click(function(){
     if(error['username']==1){
   return false;
  }else{
   $('form[name="myForm"]').submit();
  }
   });
 });
 </script>
 </head>
 <body>
   <form action='__URL__/doReg' method='post' name='myForm'>
     用 户 名：<input type='text' name='username'/><br/>
     密　　码：<input type='password' name='password'/><br/>
     确认密码：<input type='password' name='repassword'/><br/>
     性　　 别：<input type='radio' class='radio' name='sex' value='1'/>男
    <input type='radio' class='radio' name='sex' value='0'/>女
     验证码：<input type='text' name='code'/>
             <Message:code width='30' height='30'/> //更简单的使用验证码方式
 <img src='__APP__/Public/code?w=30&h=30'onclick="this.src=this.src+'?'+Math.random()"><br/>
     <img src='__PUBLIC__/Images/register.gif' class='register'/>
     <img src='__PUBLIC__/Images/reset.gif' class='reset'/>
   </form>
 </body>
 >>>>>>>>>>>>>>
 config.php
 <?php
 return array(
 'DB_PREFIX'=>'tp_',
 'DB_DSN'='mysql://root:@localhost:3306/message',
 'TMPL_L_DELIM'=>'<{',
 'TMPL_R_DELIM'=>'}>',
 );
 ?>
 >>>>>>>>>>>>>>
 www\tp_message\ThinkPHP\Lib\Driver\TagLib
 实例化一个不存在的类！:TagLibHtml 检查文件名是否创建正确，注意分清大小写
 TagLibMessage.class.php
 <?php
 class TagLibMessage extends TagLib{
   protected $tags = array(
     'code'=>array('attr'=>'width,height','close'=>0),
   );
   public function _code($attr){
     $tag = $this->parseXmlAttr($attr,'code');
  $width = $tag['width'];
  $height = $tag['height'];
  $str = "<img src='__APP__/Public/code?w={$width}&h={$height}' onclick='this.src=this.src+\"?\"+Math.random()'/>";
  return $str;
   }
 }
 ?>
 >>>>>>>>>>>>>>
 CommonAction.class.php
 <?php
 class CommonAction extends Action{
   public function _initialize(){
     if(!isset($_SESSION['username']) || $_SESSION['username']==''){
   $this->redirect('Login/login');
  }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 Home\Lib\Model
 UserModel.class.php
 <?php
 class UserModel extends Model{
   protected $_validate = array(
     array('code','require','验证码必须填写'), 
  array('code','checkCode','验证码错误',0,'callback',1),
  array('username','require','用户名必须填写'),
  array('username','','用户名已存在',0,'unique',1),
  array('username','/^\w{6,}$/','用户名必须是6个字母',0,'regex',1),
  array('repassword','password','确认密码不正确',0,'confirm')
   );
   protected function checkCode($code){
     if(md5($code)!=$_SESSION['code']){
   return false;
  }else{
   return true;
  }
   }
 }
 ?>
 
=========================================================================================
第三十课大纲

#
 # ThinkPHP 3.1.2 关联模型与分页效果
 #
 讲师：赵桐正
 微博：http://weibo.com/zhaotongzheng
 本节课知识点：
 1.关联模型使用
 2.分页的使用
 
第三十课配置项

'URL_PATHINFO_DEPR'=>'-',//修改URL的分隔符
 'TMPL_L_DELIM'=>'<{', //修改左定界符
 'TMPL_R_DELIM'=>'}>', //修改右定界符
 'DB_TYPE'=>'mysql',   //设置数据库类型
 'DB_HOST'=>'localhost',//设置主机
 'DB_NAME'=>'thinkphp',//设置数据库名
 'DB_USER'=>'root',    //设置用户名
 'DB_PWD'=>'',        //设置密码
 'DB_PORT'=>'3306',   //设置端口号
 'DB_PREFIX'=>'tp_',  //设置表前缀
 'DB_DSN'=>'mysql://root:@localhost:3306/thinkphp',//使用DSN方式配置数据库信息
 'SHOW_PAGE_TRACE'=>true,//开启页面Trace
 'TMPL_TEMPLATE_SUFFIX'=>'.html',//更改模板文件后缀名
 'TMPL_FILE_DEPR'=>'_',//修改模板文件目录层次
 'TMPL_DETECT_THEME'=>true,//自动侦测模板主题
 'THEME_LIST'=>'your,my',//支持的模板主题列表
 'TMPL_PARSE_STRING'=>array(           //添加自己的模板变量规则
  '__CSS__'=>__ROOT__.'/Public/Css',
  '__JS__'=>__ROOT__.'/Public/Js',
 ),
 'LAYOUT_ON'=>true,//开启模板渲染
 'URL_CASE_INSENSITIVE'=>true,//url不区分大小写
 'URL_HTML_SUFFIX'=>'html|shtml|xml',//限制伪静态的后缀
 'APP_GROUP_LIST' => 'Home,Admin', //项目分组设定
 'DEFAULT_GROUP'  => 'Home', //默认分组

第三十课代码

IndexAction.class.php
 <?php
 // 本类由系统自动生成，仅供测试用途
 class IndexAction extends CommonAction {
     public function index(){
   //dump(M('user')->select());
  $this->display();
     }
  public function top(){
   $this->assign('name',$_SESSION['username']);
   $this->display();
  }
  public function left(){
   //获取message表中的所有数据
   $message=D('Message');
           import('ORG.Util.Page');
           $count=$message->count();//获取总数
           $page = new Page($count,2);
           $page->setConfig('header','条信息');
           $show=$page->show();//返回分页信息
 

  $arr=$message->relation(true)->limit($page->firstRow.','.$page->listRows)->select();
           <!--foreach($arr as $v){
             $uid=$v['uid'];
             $user=M('User');
             $arr_user[]=$user->field('username')->find($uid);
           }-->
           $this->assign('list',$arr);
           $this->assign('show',$show);
   $this->display();
  }
  public function right(){
   $this->display();
  } 
 }
 ?>
 >>>>>>>>>>>>>>
 index.html
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Index</title>
 </head>
 <body>
 <frameset rows='20%,*'>
    <frame src='__URL__/top' name='top'/>
    <frameset cols='50%,50%'>
       <frame src='__URL__/left' name='left'>
       <frame src='__URL__/right' name='right'>
    </frameset>
 </frameset>
 </body>
 </html>
 >>>>>>>>>>>>>>
 top.html
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>top</title>
 </head>
 <body>
 <h1>ThinkPHP留言板系统</h1>
 <!--<p 欢迎你{$name}><a href='__APP__/Login/doLogout' target='_top'>退出</a></p>-->
 <p 欢迎你{$Think.session.username}><a>退出</a></p>
 </body>
 </html>
 >>>>>>>>>>>>>>
 left.html
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>left</title>
 </head>
 <body>
 <foreach name='list' item='vo'>
 <p>留言题目：</p><{$vo.title}><br />
 <p>留言内容：</p><{$vo.content}><br />
 <p>留言时间：</p><{$vo.time|date='Y m d H:i:s',###}><br />
 <p>留言人：</p><{$vo.username}><br />
 <p>附件名：</p><{$vo.filename}><br />
 <hr>
 </foreach>
 <{show}>
 </body>
 </html>
 >>>>>>>>>>>>>>
 right.html
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>right</title>
 </head>
 <body action='__APP__/Message/doMess' method='post' enctype='multipart/form-data'>
 留言题目:<input type='text' name='title'/><br/>
 留言内容:<textarea name='content'></textarea><br>
 选择附件:<input type='file' name='filename'/><br/>
 <input type='submit'/>
 </body>
 </html>
 >>>>>>>>>>>>>>
 LoginAction.class.php
 <?php
 class LoginAction extends Action{
   public function login(){
     $this->display();
   }
   public function doLogin(){
     //接收值
     //判断用户在数据库中是否存在
     //存在 允许登陆
     //不存在 显示错误信息
     $username=$_POST['username'];
     $password=$_POST['password'];
     $code=$_POST['code'];
     if(md5($code)!=$_SESSION['code']){
         $this->error('验证码不正确');
     }
     $user=M('User');
     $where['username']=$username;
     $where['passwrd']=$password;
     //$count=$user->where($where)->count();
     //if($count>0){
       //$_SESSION['username']=$username;
       //$this->success('用户登陆成功',U('Index/index'));
     //}else{
       //$this->error('该用户不存在');
     //}
     $arr=$user->field('id')->where($where)->find();
     if($arr){
         $_SESSION['username']=$username;
         $_SESSION['id']=$arr['id'];
         $this->success('用户登陆成功',U('Index/index'));
     }else{
         $this->error('该用户不存在');
     }
     //退出
     public function doLogout(){
       $_SESSION=array();    
       if(isset($_COOKIE[session_name()])){
         setcookie(session_name(),'',time()-1,'/'); //time()-1让时间过期
       }
       session_destroy(); //它可以把服务器端的SESSION文件删掉
       $this->redirect('Index/index');
     }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 login.html
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Index</title>
 <load href="__PUBLIC__/Css/basic.css"/>
 <load href="__PUBLIC__/Css/Home/login.css"/>
 <load href="__PUBLIC__/Js/jquery.js"/>
 <style>
 *{
 padding:0;
 margin:0;
 }
 form{
 width:300px;
 margin:0 auto;
 }
 form input{
 width:120px;
 height:30px;
 margin-top:30px;
 }
 form img{
 position:relative;
 top:10px;
 }
 </style>
 <script>
 $(function(){
   $('img[title="login"]').click(function(){
     $('form[name="myForm"]').submit();
   });
   $('img[class="register"]').click(function(){
     window.location='__APP__/Register/reg';
   });
 });
 </script>
 </head>
 <body>
   <form action='__URL__/doLogin' method='post' name='myForm'>
     用户名：<input type='text' name='username'/><br/>
     密　码：<input type='password' name='password'/><br/>
     验证码：<input type='text' name='code'/><img src='__APP__/Public/code?w=30&h=30'onclick="this.src=this.src+'?'+Math.random()"><br/>
     <img src='__PUBLIC__/Images/login.gif' title='login'/>
     <img src='__PUBLIC__/Images/register.gif' class='register'/>
   </form>
 </body>
 >>>>>>>>>>>>>>
 MessageAction.class.php
 <?php
 class MessageAction extends Action{
   public function doMess(){
     $message=D('Message');
     $message->create();
     import('ORG.Net.UploadFile');
     $upload = new UploadFile();//实例化上传类
     $upload->savePath = './Public/Uploads/';//设置附件上传目录
     if(!$upload->upload()){//上传错误提示错误信息
       $this->error($upload->getErrorMsG());
     }else{//上传成功 获取上传信息
       $info = $upload->getUploadFileInfo();
     }    
     $message->filename=$info[0]['savename'];
     $lastId=$message->add();
     if($lastId){
       $this->success('数据写入成功');
     }else{
       $this->error(留言失败);
     }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 PublicAction.class.php(tp_message\ThinkPHP\Extend\Library\ORG\Util\Image.class.php)
 <?php
   class PublicAction extends Action{
     public function code(){
       $w=isset($_GET['w'])?$_GET['w']:30;
       $h=isset($_GET['h'])?$_GET['h']:30;
       import('ORG.Util.Image');
       image::buildImageVerify(2,1,'png',$w,$h,'code');
     }
   }
 ?>
 >>>>>>>>>>>>>>
 RegisterAction.class.php
 <?php
 class RegisterAction extends Action{
   public function reg(){
     $this->display();
   }
   //检查用户是否注册过
   public function checkName(){
     $username=$_GET['username'];
  $user=M('user');
  $where['username']=$username;
  $count=$user->where($where)->count();
  if($count>0){
   echo '不允许';
  }else{
   echo '允许';
  }
   }
   //注册
   public function doReg(){
     $user=D('User');  //User要和UserModel一样
     if(!$user->create()){
       $this->error($user->getError());
     }
     //$user->ceate(); 自动创建 三大自动里面第一自动
     $lastId=$user->add();
     if($lastId){
       $this->redirect('Index/index');
     }else{
       $this->error('用户注册失败');
     }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 reg.html  注册模板文件
 <taglib name='Message' />
 <html>
 <head>
 <meta http-equiv="content/type" content="text/html;charset=UTF-8">
 <title>Register</title>
 <load href="__PUBLIC__/Css/basic.css"/>
 <load href="__PUBLIC__/Css/Home/reg.css"/>
 <load href="__PUBLIC__/Js/jquery.js"/>
 <style>
 *{
 padding:0;
 margin:0;
 }
 form{
 width:300px;
 margin:0 auto;
 }
 form input{
 width:120px;
 height:30px;
 margin-top:30px;
 }
 form img{
 position:relative;
 top:10px;
 }
 form input.radio{
 width:30px;
 height:10px;
 }
 </style>
 <script>
 $(function(){
   var error = new Array(); //Array大写
   $('input[name="username"]').blur(function(){
       var username=$(this).val();
       $.get('__URL__/checkName',{'username':username},function(data){
     if(data=='不允许'){
   error['username']=1;
   $('input[name="username"]').after('<p id="message" style="color:red">该用户名已注册</p>');
  }else{
   error['username']=0;
   $('#message').remove();
  }
   }); 
   });
   $('img.register').click(function(){
     if(error['username']==1){
   return false;
  }else{
   $('form[name="myForm"]').submit();
  }
   });
 });
 </script>
 </head>
 <body>
   <form action='__URL__/doReg' method='post' name='myForm'>
     用 户 名：<input type='text' name='username'/><br/>
     密　　码：<input type='password' name='password'/><br/>
     确认密码：<input type='password' name='repassword'/><br/>
     性　　 别：<input type='radio' class='radio' name='sex' value='1'/>男
    <input type='radio' class='radio' name='sex' value='0'/>女
     验证码：<input type='text' name='code'/>
             <Message:code width='30' height='30'/> //更简单的使用验证码方式
 <img src='__APP__/Public/code?w=30&h=30'onclick="this.src=this.src+'?'+Math.random()"><br/>
     <img src='__PUBLIC__/Images/register.gif' class='register'/>
     <img src='__PUBLIC__/Images/reset.gif' class='reset'/>
   </form>
 </body>
 >>>>>>>>>>>>>>
 config.php
 <?php
 return array(
 'DB_PREFIX'=>'tp_',
 'DB_DSN'='mysql://root:@localhost:3306/message',
 'TMPL_L_DELIM'=>'<{',
 'TMPL_R_DELIM'=>'}>',
 );
 ?>
 >>>>>>>>>>>>>>
 www\tp_message\ThinkPHP\Lib\Driver\TagLib
 实例化一个不存在的类！:TagLibHtml 检查文件名是否创建正确，注意分清大小写
 TagLibMessage.class.php
 <?php
 class TagLibMessage extends TagLib{
   protected $tags = array(
     'code'=>array('attr'=>'width,height','close'=>0),
   );
   public function _code($attr){
     $tag = $this->parseXmlAttr($attr,'code');
  $width = $tag['width'];
  $height = $tag['height'];
  $str = "<img src='__APP__/Public/code?w={$width}&h={$height}' onclick='this.src=this.src+\"?\"+Math.random()'/>";
  return $str;
   }
 }
 ?>
 >>>>>>>>>>>>>>
 CommonAction.class.php
 <?php
 class CommonAction extends Action{
   public function _initialize(){
     if(!isset($_SESSION['username']) || $_SESSION['username']==''){
   $this->redirect('Login/login');
  }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 Home\Lib\Model
 UserModel.class.php
 <?php
 class UserModel extends Model{
   protected $_validate = array(
     array('code','require','验证码必须填写'), 
  array('code','checkCode','验证码错误',0,'callback',1),
  array('username','require','用户名必须填写'),
  array('username','','用户名已存在',0,'unique',1),
  array('username','/^\w{6,}$/','用户名必须是6个字母',0,'regex',1),
  array('repassword','password','确认密码不正确',0,'confirm')
   );
   protected function checkCode($code){
     if(md5($code)!=$_SESSION['code']){
   return false;
  }else{
   return true;
  }
   }
 }
 ?>
 >>>>>>>>>>>>>>
 Home\Lib\Model 为model创建实例对象
 MessageModel.class.php
 <?php
 class MessageModel extends RelationModel{
   protected $_auto=array(
     array('time','time',1,'function'),
  array('uid','getId',1,'callback')
   );
   protected $_link=array(  //关联的规则
     'User'=>array(
   'mapping_type'=>BELONGS_TO,
   'class_name'=>'User',//这一行可以删掉
   'foreign_key'=>'uid',
   'mapping_name'=>'user',
   'mapping_fields'=>'username',
   'as_fields'=>'username',//加冒号可以修改名称防止名称冲突
  ),
   );
   protected function getId(){
     return $_SESSION['id'];
   }
 }
 ?>
 
=========================================================================================
